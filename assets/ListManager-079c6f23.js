import{r as x,c as ft,a2 as ht,a3 as pe,a4 as fe,R as _,V as xt,k as ge,a5 as mt,j as a,a6 as we,o as H,A as N,q as gt,T as be,s as wt,t as bt,x as vt,y as ve,a7 as It,M as Dt,a8 as he,a9 as St,aa as yt}from"./index-dcda7226.js";import{D as Ct,u as Ot,g as _t,S as X,a as jt,b as Pt,c as Et,d as Rt}from"./LabeledSegmentedControl-3be3696c.js";import{c as Lt,T as Ie,f as kt,g as Tt}from"./index-63df7c55.js";import{I as xe}from"./useCollectionDataPersistent-fc3286a8.js";function Vt(t){return n=>{if(!n)t(n);else if(typeof n=="function")t(n);else if(typeof n=="object"&&"nativeEvent"in n){const{currentTarget:o}=n;o.type==="checkbox"?t(o.checked):t(o.value)}else t(n)}}function De(t){const[n,o]=x.exports.useState(t);return[n,Vt(o)]}function zt({data:t,searchable:n,limit:o,searchValue:r,filter:v,value:D,filterDataOnExactSearchMatch:S}){if(!n)return t;const u=D!=null&&t.find(l=>l.value===D)||null;if(u&&!S&&(u==null?void 0:u.label)===r){if(o){if(o>=t.length)return t;const l=t.indexOf(u),O=l+o,i=O-t.length;return i>0?t.slice(l-i):t.slice(l,O)}return t}const m=[];for(let l=0;l<t.length&&(v(r,t[l])&&m.push(t[l]),!(m.length>=o));l+=1);return m}var Mt=ft(()=>({input:{"&:not(:disabled)":{cursor:"pointer","&::selection":{backgroundColor:"transparent"}}}}));const Ft=Mt;var Bt=Object.defineProperty,$t=Object.defineProperties,At=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable,me=(t,n,o)=>n in t?Bt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,z=(t,n)=>{for(var o in n||(n={}))Se.call(n,o)&&me(t,o,n[o]);if(K)for(var o of K(n))ye.call(n,o)&&me(t,o,n[o]);return t},Y=(t,n)=>$t(t,At(n)),Ht=(t,n)=>{var o={};for(var r in t)Se.call(t,r)&&n.indexOf(r)<0&&(o[r]=t[r]);if(t!=null&&K)for(var r of K(t))n.indexOf(r)<0&&ye.call(t,r)&&(o[r]=t[r]);return o};function Nt(t,n){return n.label.toLowerCase().trim().includes(t.toLowerCase().trim())}function Kt(t,n){return!!t&&!n.some(o=>o.label.toLowerCase()===t.toLowerCase())}const Ut={required:!1,size:"sm",shadow:"sm",itemComponent:Ct,transition:"fade",transitionDuration:0,initiallyOpened:!1,filter:Nt,maxDropdownHeight:220,searchable:!1,clearable:!1,limit:1/0,disabled:!1,creatable:!1,shouldCreate:Kt,selectOnBlur:!1,switchDirectionOnFlip:!1,filterDataOnExactSearchMatch:!1,zIndex:ht("popover"),clearButtonTabIndex:0,positionDependencies:[],dropdownPosition:"flip"},Wt=x.exports.forwardRef((t,n)=>{const o=Lt("Select",Ut,t),{inputProps:r,wrapperProps:v,shadow:D,data:S,value:u,defaultValue:m,onChange:l,itemComponent:O,onKeyDown:i,onBlur:ee,onFocus:te,transition:Ce,transitionDuration:Oe,initiallyOpened:_e,transitionTimingFunction:Zt,unstyled:ne,classNames:L,styles:M,filter:je,maxDropdownHeight:Pe,searchable:I,clearable:U,nothingFound:oe,clearButtonLabel:Ee,limit:Re,disabled:W,onSearchChange:q,searchValue:Le,rightSection:ke,rightSectionWidth:Te,creatable:Ve,getCreateLabel:ae,shouldCreate:ze,selectOnBlur:Me,onCreate:re,dropdownComponent:Fe,onDropdownClose:Be,onDropdownOpen:$e,withinPortal:Ae,switchDirectionOnFlip:He,zIndex:Ne,name:Ke,dropdownPosition:Ue,allowDeselect:se,placeholder:We,filterDataOnExactSearchMatch:qe,clearButtonTabIndex:Ze,form:Ge,positionDependencies:Je,readOnly:j}=o,Qe=Ht(o,["inputProps","wrapperProps","shadow","data","value","defaultValue","onChange","itemComponent","onKeyDown","onBlur","onFocus","transition","transitionDuration","initiallyOpened","transitionTimingFunction","unstyled","classNames","styles","filter","maxDropdownHeight","searchable","clearable","nothingFound","clearButtonLabel","limit","disabled","onSearchChange","searchValue","rightSection","rightSectionWidth","creatable","getCreateLabel","shouldCreate","selectOnBlur","onCreate","dropdownComponent","onDropdownClose","onDropdownOpen","withinPortal","switchDirectionOnFlip","zIndex","name","dropdownPosition","allowDeselect","placeholder","filterDataOnExactSearchMatch","clearButtonTabIndex","form","positionDependencies","readOnly"]),{classes:Xe,cx:Ye,theme:et}=Ft(),[p,tt]=x.exports.useState(_e),[y,d]=x.exports.useState(-1),Z=x.exports.useRef(),F=x.exports.useRef({}),[le,nt]=x.exports.useState("column"),P=le==="column",{scrollIntoView:T,targetRef:G,scrollableRef:ot}=Ot({duration:0,offset:5,cancelable:!1,isList:!0}),at=se===void 0?U:se,g=e=>{if(p!==e){tt(e);const s=e?$e:Be;typeof s=="function"&&s()}},J=Ve&&typeof ae=="function";let Q=null;const rt=S.map(e=>typeof e=="string"?{label:e,value:e}:e),B=_t({data:rt}),[w,k,ie]=pe({value:u,defaultValue:m,finalValue:null,onChange:l}),C=B.find(e=>e.value===w),[E,st]=pe({value:Le,defaultValue:(C==null?void 0:C.label)||"",finalValue:void 0,onChange:q}),R=e=>{st(e),I&&typeof q=="function"&&q(e)},lt=()=>{var e;j||(k(null),ie||R(""),(e=Z.current)==null||e.focus())};x.exports.useEffect(()=>{const e=B.find(s=>s.value===w);e?R(e.label):(!J||!w)&&R("")},[w]),x.exports.useEffect(()=>{C&&(!I||!p)&&R(C.label)},[C==null?void 0:C.label]);const $=e=>{if(!j)if(at&&(C==null?void 0:C.value)===e.value)k(null),g(!1);else{if(e.creatable&&typeof re=="function"){const s=re(e.value);typeof s<"u"&&s!==null&&k(typeof s=="string"?s:s.value)}else k(e.value);ie||R(e.label),d(-1),g(!1),Z.current.focus()}},c=zt({data:B,searchable:I,limit:Re,searchValue:E,filter:je,filterDataOnExactSearchMatch:qe,value:w});J&&ze(E,c)&&(Q=ae(E),c.push({label:E,value:E,creatable:!0}));const ce=(e,s,f)=>{let h=e;for(;f(h);)if(h=s(h),!c[h].disabled)return h;return e};fe(()=>{d(-1)},[E]);const V=w?c.findIndex(e=>e.value===w):0,b=!j&&(c.length>0?p:p&&!!oe),ue=()=>{d(e=>{var s;const f=ce(e,h=>h-1,h=>h>0);return G.current=F.current[(s=c[f])==null?void 0:s.value],b&&T({alignment:P?"start":"end"}),f})},de=()=>{d(e=>{var s;const f=ce(e,h=>h+1,h=>h<c.length-1);return G.current=F.current[(s=c[f])==null?void 0:s.value],b&&T({alignment:P?"end":"start"}),f})},A=()=>window.setTimeout(()=>{var e;G.current=F.current[(e=c[V])==null?void 0:e.value],T({alignment:P?"end":"start"})},0);fe(()=>{b&&A()},[b]);const it=e=>{switch(typeof i=="function"&&i(e),e.key){case"ArrowUp":{e.preventDefault(),p?P?ue():de():(d(V),g(!0),A());break}case"ArrowDown":{e.preventDefault(),p?P?de():ue():(d(V),g(!0),A());break}case"Home":{if(!I){e.preventDefault(),p||g(!0);const s=c.findIndex(f=>!f.disabled);d(s),b&&T({alignment:P?"end":"start"})}break}case"End":{if(!I){e.preventDefault(),p||g(!0);const s=c.map(f=>!!f.disabled).lastIndexOf(!1);d(s),b&&T({alignment:P?"end":"start"})}break}case"Escape":{e.preventDefault(),g(!1),d(-1);break}case" ":{I||(e.preventDefault(),c[y]&&p?$(c[y]):(g(!0),d(V),A()));break}case"Enter":I||e.preventDefault(),c[y]&&p&&(e.preventDefault(),$(c[y]))}},ct=e=>{typeof ee=="function"&&ee(e);const s=B.find(f=>f.value===w);Me&&c[y]&&p&&$(c[y]),R((s==null?void 0:s.label)||""),g(!1)},ut=e=>{typeof te=="function"&&te(e),I&&g(!0)},dt=e=>{j||(R(e.currentTarget.value),U&&e.currentTarget.value===""&&k(null),d(-1),g(!0))},pt=()=>{j||(g(!p),w&&!p&&d(V))};return _.createElement(xe.Wrapper,Y(z({},v),{__staticSelector:"Select"}),_.createElement(X,{opened:b,transition:Ce,transitionDuration:Oe,shadow:"sm",withinPortal:Ae,__staticSelector:"Select",onDirectionChange:nt,switchDirectionOnFlip:He,zIndex:Ne,dropdownPosition:Ue,positionDependencies:Je,classNames:L,styles:M,unstyled:ne},_.createElement(X.Target,null,_.createElement("div",{role:"combobox","aria-haspopup":"listbox","aria-owns":b?`${r.id}-items`:null,"aria-controls":r.id,"aria-expanded":b,onMouseLeave:()=>d(-1),tabIndex:-1},_.createElement("input",{type:"hidden",name:Ke,value:w||"",form:Ge,disabled:W}),_.createElement(xe,z(Y(z(z({autoComplete:"off",type:"search"},r),Qe),{ref:xt(n,Z),onKeyDown:it,__staticSelector:"Select",value:E,placeholder:We,onChange:dt,"aria-autocomplete":"list","aria-controls":b?`${r.id}-items`:null,"aria-activedescendant":y>=0?`${r.id}-${y}`:null,onMouseDown:pt,onBlur:ct,onFocus:ut,readOnly:!I||j,disabled:W,"data-mantine-stop-propagation":b,name:null,classNames:Y(z({},L),{input:Ye({[Xe.input]:!I},L==null?void 0:L.input)})}),jt({theme:et,rightSection:ke,rightSectionWidth:Te,styles:M,size:r.size,shouldClear:U&&!!C,clearButtonLabel:Ee,onClear:lt,error:v.error,clearButtonTabIndex:Ze,disabled:W,readOnly:j}))))),_.createElement(X.Dropdown,{component:Fe||Pt,maxHeight:Pe,direction:le,id:r.id,innerRef:ot,__staticSelector:"Select",classNames:L,styles:M},_.createElement(Et,{data:c,hovered:y,classNames:L,styles:M,isItemSelected:e=>e===w,uuid:r.id,__staticSelector:"Select",onItemHover:d,onItemSelect:$,itemsRefs:F,itemComponent:O,size:r.size,nothingFound:oe,creatable:J&&!!Q,createLabel:Q,"aria-label":v.label,unstyled:ne}))))});Wt.displayName="@mantine/core/Select";function qt({item:t,label:n}){const o=ge(),r=mt(()=>S(!1)),v=x.exports.useRef(null),[D,S]=x.exports.useState(!1),[u,m]=De(t.name),l=`${n}s`,O=()=>vt({title:a.exports.jsx(ve,{order:5,children:`Are you sure you want to delete this ${n}?`}),labels:{confirm:"Delete",cancel:"Cancel"},onConfirm:()=>Tt(l,t.id),confirmProps:{color:"red"},size:"auto",centered:!0,target:".modal-container",zIndex:3});return x.exports.useEffect(()=>{var i;D&&(m(t.name),(i=v.current)==null||i.focus())},[D]),a.exports.jsxs(we.div,{ref:r,style:{display:"flex",alignItems:"center"},layoutId:t.id,layoutScroll:!0,children:[D?a.exports.jsxs(a.exports.Fragment,{children:[a.exports.jsx(Ie,{ref:v,placeholder:"Enter name","data-autofocus":!0,pr:"xs",styles:i=>({input:{minHeight:34,height:34,paddingInline:i.spacing.xs-1}}),sx:{flex:1},value:u,onChange:i=>m(i)}),a.exports.jsx(H,{label:"Confirm",withinPortal:!0,children:a.exports.jsx(N,{color:o.primaryColor,onClick:()=>{S(!1),kt(l,t.id,{name:u})},children:a.exports.jsx(gt,{})})})]}):a.exports.jsxs(a.exports.Fragment,{children:[a.exports.jsx(be,{size:"sm",px:"xs",sx:{flex:1},children:t.name}),a.exports.jsx(H,{label:"Edit name",withinPortal:!0,children:a.exports.jsx(N,{color:o.primaryColor,onClick:()=>S(!0),children:a.exports.jsx(wt,{})})})]}),a.exports.jsx(H,{label:"Delete",withinPortal:!0,children:a.exports.jsx(N,{color:"red",onClick:O,children:a.exports.jsx(bt,{})})})]})}function Yt({opened:t,close:n,label:o,items:r,addItem:v}){const D=ge(),{height:S}=It(),[u,m]=De(""),l=r==null?void 0:r.filter(i=>i.name.match(new RegExp(u,"gi"))),O=!!(l!=null&&l.find(i=>i.name.toLowerCase()===u.toLowerCase()));return x.exports.useEffect(()=>{t&&m("")},[t]),a.exports.jsx(Dt,{opened:t,title:a.exports.jsx(ve,{order:5,children:`Manage ${o}s`}),size:420,overflow:"inside",trapFocus:!0,onClose:n,target:".modal-container",zIndex:2,children:a.exports.jsxs(he,{spacing:"sm",children:[a.exports.jsx(Ie,{icon:a.exports.jsx(St,{}),placeholder:`Search ${o}`,maxLength:36,"data-autofocus":!0,value:u,onChange:m}),a.exports.jsx(Rt.Autosize,{maxHeight:`calc(${S}px - 240px)`,children:a.exports.jsxs(he,{spacing:"xs",pb:2,children:[l==null?void 0:l.map(i=>a.exports.jsx(qt,{item:i,label:o},i.id)),!!u.length&&!O&&a.exports.jsxs(we.div,{style:{display:"flex",alignItems:"center"},layoutId:"search",children:[a.exports.jsx(be,{size:"sm",px:"xs",sx:{flex:1},children:u}),a.exports.jsx(H,{label:`Add ${o}`,withinPortal:!0,children:a.exports.jsx(N,{color:D.primaryColor,onClick:()=>{v({name:u}),m("")},children:a.exports.jsx(yt,{})})})]})]})})]})})}export{Yt as L,Wt as S};
