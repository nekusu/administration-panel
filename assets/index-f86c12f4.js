import{j as y,a5 as ht,a3 as Ge,aH as dt,aN as Dt,aI as Gt,G as ft,I as Yt,r as v,u as zt,aO as Vt,ar as Xt,T as nt,x as Ht,z as Fe,t as Ut,C as Kt}from"./index-5ff1983a.js";import{u as Nt,L as Qt}from"./useCollectionDataPersistent-3151dea0.js";import{C as rt,c as re,d as gt,Q as mt,p as u,R as Zt,w as Le,X as Jt,M as Ke,T as ei,F as pt,t as yt,a as ti,V as Re,b as ii,e as ni,f as ri,k as si,i as bt,g as xt,h as Ne,E as oi,j as li,l as ai,u as ui,A as _t,W as Pe,B as ci,m as hi,n as di,o as fi,r as gi,P as st,S as mi,q as ot,s as pi,H as yi,J as bi,v as lt,x as xi,y as _i,z as vt,D as vi,O as Mi}from"./nivo-legends.es-52dec924.js";import{M as Si,d as be}from"./dayjs.min-c1d4d187.js";import{a as wi,g as ki}from"./TimeRangeInput-f7df1e78.js";import{L as Ci}from"./LabeledSegmentedControl-01309ecf.js";import{c as Ti}from"./customParseFormat-84084c91.js";import"./clamp-23377890.js";const Ri=Yt(t=>({grid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:t.spacing.sm}})),ji=["Week","Month","Year","Custom"];function Oi({filters:t,updateFilter:e,dateRange:i,setDateRange:r}){const{classes:n}=Ri();return y.jsxs(ht,{className:n.grid,children:[y.jsxs(Ge,{spacing:0,children:[y.jsx(Ci,{label:"Timeframe",data:ji.map(s=>({label:s,value:s.toLowerCase()})),value:t.timeframe,onChange:s=>e({timeframe:s})}),y.jsx(dt,{in:t.timeframe==="custom",children:y.jsx(wi,{icon:y.jsx(Dt,{}),placeholder:"Select dates range",firstDayOfWeek:"sunday",pt:"md",value:i,onChange:r})})]}),y.jsx(Si,{label:"Exclude",data:ki("en","sunday","dddd").map((s,l)=>({label:s,value:l.toString()})),icon:y.jsx(Gt,{}),placeholder:"Select days",value:t.excludedDays,onChange:s=>e({excludedDays:s})}),y.jsxs(ft,{pt:6,children:[y.jsx(rt,{checked:t.enableLeftTicks,label:"Enable left ticks",onChange:({target:{checked:s}})=>e({enableLeftTicks:s})}),y.jsx(rt,{checked:t.enableBottomTicks,label:"Enable bottom ticks",onChange:({target:{checked:s}})=>e({enableBottomTicks:s})})]})]})}var Ye=Math.PI,ze=2*Ye,ye=1e-6,qi=ze-ye;function Ve(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Qe(){return new Ve}Ve.prototype=Qe.prototype={constructor:Ve,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,i,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+i)+","+(this._y1=+r)},bezierCurveTo:function(t,e,i,r,n,s){this._+="C"+ +t+","+ +e+","+ +i+","+ +r+","+(this._x1=+n)+","+(this._y1=+s)},arcTo:function(t,e,i,r,n){t=+t,e=+e,i=+i,r=+r,n=+n;var s=this._x1,l=this._y1,o=i-t,a=r-e,d=s-t,c=l-e,h=d*d+c*c;if(n<0)throw new Error("negative radius: "+n);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>ye)if(!(Math.abs(c*o-a*d)>ye)||!n)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var g=i-s,f=r-l,m=o*o+a*a,p=g*g+f*f,_=Math.sqrt(m),w=Math.sqrt(h),k=n*Math.tan((Ye-Math.acos((m+h-p)/(2*_*w)))/2),x=k/w,O=k/_;Math.abs(x-1)>ye&&(this._+="L"+(t+x*d)+","+(e+x*c)),this._+="A"+n+","+n+",0,0,"+ +(c*g>d*f)+","+(this._x1=t+O*o)+","+(this._y1=e+O*a)}},arc:function(t,e,i,r,n,s){t=+t,e=+e,i=+i,s=!!s;var l=i*Math.cos(r),o=i*Math.sin(r),a=t+l,d=e+o,c=1^s,h=s?r-n:n-r;if(i<0)throw new Error("negative radius: "+i);this._x1===null?this._+="M"+a+","+d:(Math.abs(this._x1-a)>ye||Math.abs(this._y1-d)>ye)&&(this._+="L"+a+","+d),i&&(h<0&&(h=h%ze+ze),h>qi?this._+="A"+i+","+i+",0,1,"+c+","+(t-l)+","+(e-o)+"A"+i+","+i+",0,1,"+c+","+(this._x1=a)+","+(this._y1=d):h>ye&&(this._+="A"+i+","+i+",0,"+ +(h>=Ye)+","+c+","+(this._x1=t+i*Math.cos(n))+","+(this._y1=e+i*Math.sin(n))))},rect:function(t,e,i,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +i+"v"+ +r+"h"+-i+"Z"},toString:function(){return this._}};function Mt(t){return t[0]}function St(t){return t[1]}function wt(){var t=Mt,e=St,i=re(!0),r=null,n=gt,s=null;function l(o){var a,d=o.length,c,h=!1,g;for(r==null&&(s=n(g=Qe())),a=0;a<=d;++a)!(a<d&&i(c=o[a],a,o))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+t(c,a,o),+e(c,a,o));if(g)return s=null,g+""||null}return l.x=function(o){return arguments.length?(t=typeof o=="function"?o:re(+o),l):t},l.y=function(o){return arguments.length?(e=typeof o=="function"?o:re(+o),l):e},l.defined=function(o){return arguments.length?(i=typeof o=="function"?o:re(!!o),l):i},l.curve=function(o){return arguments.length?(n=o,r!=null&&(s=n(r)),l):n},l.context=function(o){return arguments.length?(o==null?r=s=null:s=n(r=o),l):r},l}function Ei(){var t=Mt,e=null,i=re(0),r=St,n=re(!0),s=null,l=gt,o=null;function a(c){var h,g,f,m=c.length,p,_=!1,w,k=new Array(m),x=new Array(m);for(s==null&&(o=l(w=Qe())),h=0;h<=m;++h){if(!(h<m&&n(p=c[h],h,c))===_)if(_=!_)g=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),f=h-1;f>=g;--f)o.point(k[f],x[f]);o.lineEnd(),o.areaEnd()}_&&(k[h]=+t(p,h,c),x[h]=+i(p,h,c),o.point(e?+e(p,h,c):k[h],r?+r(p,h,c):x[h]))}if(w)return o=null,w+""||null}function d(){return wt().defined(n).curve(l).context(s)}return a.x=function(c){return arguments.length?(t=typeof c=="function"?c:re(+c),e=null,a):t},a.x0=function(c){return arguments.length?(t=typeof c=="function"?c:re(+c),a):t},a.x1=function(c){return arguments.length?(e=c==null?null:typeof c=="function"?c:re(+c),a):e},a.y=function(c){return arguments.length?(i=typeof c=="function"?c:re(+c),r=null,a):i},a.y0=function(c){return arguments.length?(i=typeof c=="function"?c:re(+c),a):i},a.y1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:re(+c),a):r},a.lineX0=a.lineY0=function(){return d().x(t).y(i)},a.lineY1=function(){return d().x(t).y(r)},a.lineX1=function(){return d().x(e).y(i)},a.defined=function(c){return arguments.length?(n=typeof c=="function"?c:re(!!c),a):n},a.curve=function(c){return arguments.length?(l=c,s!=null&&(o=l(s)),a):l},a.context=function(c){return arguments.length?(c==null?s=o=null:o=l(s=c),a):s},a}const at=Math.pow(2,-52),Be=new Uint32Array(512);class Ie{static from(e,i=Ii,r=Wi){const n=e.length,s=new Float64Array(n*2);for(let l=0;l<n;l++){const o=e[l];s[2*l]=i(o),s[2*l+1]=r(o)}return new Ie(s)}constructor(e){const i=e.length>>1;if(i>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const r=Math.max(2*i-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(i)),this._hullPrev=new Uint32Array(i),this._hullNext=new Uint32Array(i),this._hullTri=new Uint32Array(i),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(i),this._dists=new Float64Array(i),this.update()}update(){const{coords:e,_hullPrev:i,_hullNext:r,_hullTri:n,_hullHash:s}=this,l=e.length>>1;let o=1/0,a=1/0,d=-1/0,c=-1/0;for(let b=0;b<l;b++){const M=e[2*b],j=e[2*b+1];M<o&&(o=M),j<a&&(a=j),M>d&&(d=M),j>c&&(c=j),this._ids[b]=b}const h=(o+d)/2,g=(a+c)/2;let f=1/0,m,p,_;for(let b=0;b<l;b++){const M=$e(h,g,e[2*b],e[2*b+1]);M<f&&(m=b,f=M)}const w=e[2*m],k=e[2*m+1];f=1/0;for(let b=0;b<l;b++){if(b===m)continue;const M=$e(w,k,e[2*b],e[2*b+1]);M<f&&M>0&&(p=b,f=M)}let x=e[2*p],O=e[2*p+1],W=1/0;for(let b=0;b<l;b++){if(b===m||b===p)continue;const M=Ai(w,k,x,O,e[2*b],e[2*b+1]);M<W&&(_=b,W=M)}let F=e[2*_],A=e[2*_+1];if(W===1/0){for(let j=0;j<l;j++)this._dists[j]=e[2*j]-e[0]||e[2*j+1]-e[1];Se(this._ids,this._dists,0,l-1);const b=new Uint32Array(l);let M=0;for(let j=0,q=-1/0;j<l;j++){const P=this._ids[j];this._dists[P]>q&&(b[M++]=P,q=this._dists[P])}this.hull=b.subarray(0,M),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Ae(w,k,x,O,F,A)){const b=p,M=x,j=O;p=_,x=F,O=A,_=b,F=M,A=j}const T=Pi(w,k,x,O,F,A);this._cx=T.x,this._cy=T.y;for(let b=0;b<l;b++)this._dists[b]=$e(e[2*b],e[2*b+1],T.x,T.y);Se(this._ids,this._dists,0,l-1),this._hullStart=m;let R=3;r[m]=i[_]=p,r[p]=i[m]=_,r[_]=i[p]=m,n[m]=0,n[p]=1,n[_]=2,s.fill(-1),s[this._hashKey(w,k)]=m,s[this._hashKey(x,O)]=p,s[this._hashKey(F,A)]=_,this.trianglesLen=0,this._addTriangle(m,p,_,-1,-1,-1);for(let b=0,M,j;b<this._ids.length;b++){const q=this._ids[b],P=e[2*q],$=e[2*q+1];if(b>0&&Math.abs(P-M)<=at&&Math.abs($-j)<=at||(M=P,j=$,q===m||q===p||q===_))continue;let G=0;for(let z=0,ee=this._hashKey(P,$);z<this._hashSize&&(G=s[(ee+z)%this._hashSize],!(G!==-1&&G!==r[G]));z++);G=i[G];let C=G,E;for(;E=r[C],!Ae(P,$,e[2*C],e[2*C+1],e[2*E],e[2*E+1]);)if(C=E,C===G){C=-1;break}if(C===-1)continue;let U=this._addTriangle(C,q,r[C],-1,-1,n[C]);n[q]=this._legalize(U+2),n[C]=U,R++;let Y=r[C];for(;E=r[Y],Ae(P,$,e[2*Y],e[2*Y+1],e[2*E],e[2*E+1]);)U=this._addTriangle(Y,q,E,n[q],-1,n[Y]),n[q]=this._legalize(U+2),r[Y]=Y,R--,Y=E;if(C===G)for(;E=i[C],Ae(P,$,e[2*E],e[2*E+1],e[2*C],e[2*C+1]);)U=this._addTriangle(E,q,C,-1,n[C],n[E]),this._legalize(U+2),n[E]=U,r[C]=C,R--,C=E;this._hullStart=i[q]=C,r[C]=i[Y]=q,r[q]=Y,s[this._hashKey(P,$)]=q,s[this._hashKey(e[2*C],e[2*C+1])]=C}this.hull=new Uint32Array(R);for(let b=0,M=this._hullStart;b<R;b++)this.hull[b]=M,M=r[M];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,i){return Math.floor(Li(e-this._cx,i-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:i,_halfedges:r,coords:n}=this;let s=0,l=0;for(;;){const o=r[e],a=e-e%3;if(l=a+(e+2)%3,o===-1){if(s===0)break;e=Be[--s];continue}const d=o-o%3,c=a+(e+1)%3,h=d+(o+2)%3,g=i[l],f=i[e],m=i[c],p=i[h];if(Bi(n[2*g],n[2*g+1],n[2*f],n[2*f+1],n[2*m],n[2*m+1],n[2*p],n[2*p+1])){i[e]=p,i[o]=g;const w=r[h];if(w===-1){let x=this._hullStart;do{if(this._hullTri[x]===h){this._hullTri[x]=e;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(e,w),this._link(o,r[l]),this._link(l,h);const k=d+(o+1)%3;s<Be.length&&(Be[s++]=k)}else{if(s===0)break;e=Be[--s]}}return l}_link(e,i){this._halfedges[e]=i,i!==-1&&(this._halfedges[i]=e)}_addTriangle(e,i,r,n,s,l){const o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=i,this._triangles[o+2]=r,this._link(o,n),this._link(o+1,s),this._link(o+2,l),this.trianglesLen+=3,o}}function Li(t,e){const i=t/(Math.abs(t)+Math.abs(e));return(e>0?3-i:1+i)/4}function $e(t,e,i,r){const n=t-i,s=e-r;return n*n+s*s}function De(t,e,i,r,n,s){const l=(r-e)*(n-t),o=(i-t)*(s-e);return Math.abs(l-o)>=33306690738754716e-32*Math.abs(l+o)?l-o:0}function Ae(t,e,i,r,n,s){return(De(n,s,t,e,i,r)||De(t,e,i,r,n,s)||De(i,r,n,s,t,e))<0}function Bi(t,e,i,r,n,s,l,o){const a=t-l,d=e-o,c=i-l,h=r-o,g=n-l,f=s-o,m=a*a+d*d,p=c*c+h*h,_=g*g+f*f;return a*(h*_-p*f)-d*(c*_-p*g)+m*(c*f-h*g)<0}function Ai(t,e,i,r,n,s){const l=i-t,o=r-e,a=n-t,d=s-e,c=l*l+o*o,h=a*a+d*d,g=.5/(l*d-o*a),f=(d*c-o*h)*g,m=(l*h-a*c)*g;return f*f+m*m}function Pi(t,e,i,r,n,s){const l=i-t,o=r-e,a=n-t,d=s-e,c=l*l+o*o,h=a*a+d*d,g=.5/(l*d-o*a),f=t+(d*c-o*h)*g,m=e+(l*h-a*c)*g;return{x:f,y:m}}function Se(t,e,i,r){if(r-i<=20)for(let n=i+1;n<=r;n++){const s=t[n],l=e[s];let o=n-1;for(;o>=i&&e[t[o]]>l;)t[o+1]=t[o--];t[o+1]=s}else{const n=i+r>>1;let s=i+1,l=r;Te(t,n,s),e[t[i]]>e[t[r]]&&Te(t,i,r),e[t[s]]>e[t[r]]&&Te(t,s,r),e[t[i]]>e[t[s]]&&Te(t,i,s);const o=t[s],a=e[o];for(;;){do s++;while(e[t[s]]<a);do l--;while(e[t[l]]>a);if(l<s)break;Te(t,s,l)}t[i+1]=t[l],t[l]=o,r-s+1>=l-i?(Se(t,e,s,r),Se(t,e,i,l-1)):(Se(t,e,i,l-1),Se(t,e,s,r))}}function Te(t,e,i){const r=t[e];t[e]=t[i],t[i]=r}function Ii(t){return t[0]}function Wi(t){return t[1]}const ut=1e-6;class xe{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,i){this._+=`L${this._x1=+e},${this._y1=+i}`}arc(e,i,r){e=+e,i=+i,r=+r;const n=e+r,s=i;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${n},${s}`:(Math.abs(this._x1-n)>ut||Math.abs(this._y1-s)>ut)&&(this._+="L"+n+","+s),r&&(this._+=`A${r},${r},0,1,1,${e-r},${i}A${r},${r},0,1,1,${this._x1=n},${this._y1=s}`)}rect(e,i,r,n){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+i}h${+r}v${+n}h${-r}Z`}value(){return this._||null}}class Xe{constructor(){this._=[]}moveTo(e,i){this._.push([e,i])}closePath(){this._.push(this._[0].slice())}lineTo(e,i){this._.push([e,i])}value(){return this._.length?this._:null}}class Fi{constructor(e,[i,r,n,s]=[0,0,960,500]){if(!((n=+n)>=(i=+i))||!((s=+s)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=n,this.xmin=i,this.ymax=s,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:i,triangles:r},vectors:n}=this,s=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let f=0,m=0,p=r.length,_,w;f<p;f+=3,m+=2){const k=r[f]*2,x=r[f+1]*2,O=r[f+2]*2,W=e[k],F=e[k+1],A=e[x],T=e[x+1],R=e[O],b=e[O+1],M=A-W,j=T-F,q=R-W,P=b-F,$=M*M+j*j,G=q*q+P*P,C=(M*P-j*q)*2;if(!C)_=(W+R)/2-1e8*P,w=(F+b)/2+1e8*q;else if(Math.abs(C)<1e-8)_=(W+R)/2,w=(F+b)/2;else{const E=1/C;_=W+(P*$-j*G)*E,w=F+(M*G-q*$)*E}s[m]=_,s[m+1]=w}let l=i[i.length-1],o,a=l*4,d,c=e[2*l],h,g=e[2*l+1];n.fill(0);for(let f=0;f<i.length;++f)l=i[f],o=a,d=c,h=g,a=l*4,c=e[2*l],g=e[2*l+1],n[o+2]=n[a]=h-g,n[o+3]=n[a+1]=c-d}render(e){const i=e==null?e=new xe:void 0,{delaunay:{halfedges:r,inedges:n,hull:s},circumcenters:l,vectors:o}=this;if(s.length<=1)return null;for(let c=0,h=r.length;c<h;++c){const g=r[c];if(g<c)continue;const f=Math.floor(c/3)*2,m=Math.floor(g/3)*2,p=l[f],_=l[f+1],w=l[m],k=l[m+1];this._renderSegment(p,_,w,k,e)}let a,d=s[s.length-1];for(let c=0;c<s.length;++c){a=d,d=s[c];const h=Math.floor(n[d]/3)*2,g=l[h],f=l[h+1],m=a*4,p=this._project(g,f,o[m+2],o[m+3]);p&&this._renderSegment(g,f,p[0],p[1],e)}return i&&i.value()}renderBounds(e){const i=e==null?e=new xe:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),i&&i.value()}renderCell(e,i){const r=i==null?i=new xe:void 0,n=this._clip(e);if(n===null||!n.length)return;i.moveTo(n[0],n[1]);let s=n.length;for(;n[0]===n[s-2]&&n[1]===n[s-1]&&s>1;)s-=2;for(let l=2;l<s;l+=2)(n[l]!==n[l-2]||n[l+1]!==n[l-1])&&i.lineTo(n[l],n[l+1]);return i.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let i=0,r=e.length/2;i<r;++i){const n=this.cellPolygon(i);n&&(n.index=i,yield n)}}cellPolygon(e){const i=new Xe;return this.renderCell(e,i),i.value()}_renderSegment(e,i,r,n,s){let l;const o=this._regioncode(e,i),a=this._regioncode(r,n);o===0&&a===0?(s.moveTo(e,i),s.lineTo(r,n)):(l=this._clipSegment(e,i,r,n,o,a))&&(s.moveTo(l[0],l[1]),s.lineTo(l[2],l[3]))}contains(e,i,r){return i=+i,i!==i||(r=+r,r!==r)?!1:this.delaunay._step(e,i,r)===e}*neighbors(e){const i=this._clip(e);if(i)for(const r of this.delaunay.neighbors(e)){const n=this._clip(r);if(n){e:for(let s=0,l=i.length;s<l;s+=2)for(let o=0,a=n.length;o<a;o+=2)if(i[s]==n[o]&&i[s+1]==n[o+1]&&i[(s+2)%l]==n[(o+a-2)%a]&&i[(s+3)%l]==n[(o+a-1)%a]){yield r;break e}}}}_cell(e){const{circumcenters:i,delaunay:{inedges:r,halfedges:n,triangles:s}}=this,l=r[e];if(l===-1)return null;const o=[];let a=l;do{const d=Math.floor(a/3);if(o.push(i[d*2],i[d*2+1]),a=a%3===2?a-2:a+1,s[a]!==e)break;a=n[a]}while(a!==l&&a!==-1);return o}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const i=this._cell(e);if(i===null)return null;const{vectors:r}=this,n=e*4;return r[n]||r[n+1]?this._clipInfinite(e,i,r[n],r[n+1],r[n+2],r[n+3]):this._clipFinite(e,i)}_clipFinite(e,i){const r=i.length;let n=null,s,l,o=i[r-2],a=i[r-1],d,c=this._regioncode(o,a),h,g;for(let f=0;f<r;f+=2)if(s=o,l=a,o=i[f],a=i[f+1],d=c,c=this._regioncode(o,a),d===0&&c===0)h=g,g=0,n?n.push(o,a):n=[o,a];else{let m,p,_,w,k;if(d===0){if((m=this._clipSegment(s,l,o,a,d,c))===null)continue;[p,_,w,k]=m}else{if((m=this._clipSegment(o,a,s,l,c,d))===null)continue;[w,k,p,_]=m,h=g,g=this._edgecode(p,_),h&&g&&this._edge(e,h,g,n,n.length),n?n.push(p,_):n=[p,_]}h=g,g=this._edgecode(w,k),h&&g&&this._edge(e,h,g,n,n.length),n?n.push(w,k):n=[w,k]}if(n)h=g,g=this._edgecode(n[0],n[1]),h&&g&&this._edge(e,h,g,n,n.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return n}_clipSegment(e,i,r,n,s,l){for(;;){if(s===0&&l===0)return[e,i,r,n];if(s&l)return null;let o,a,d=s||l;d&8?(o=e+(r-e)*(this.ymax-i)/(n-i),a=this.ymax):d&4?(o=e+(r-e)*(this.ymin-i)/(n-i),a=this.ymin):d&2?(a=i+(n-i)*(this.xmax-e)/(r-e),o=this.xmax):(a=i+(n-i)*(this.xmin-e)/(r-e),o=this.xmin),s?(e=o,i=a,s=this._regioncode(e,i)):(r=o,n=a,l=this._regioncode(r,n))}}_clipInfinite(e,i,r,n,s,l){let o=Array.from(i),a;if((a=this._project(o[0],o[1],r,n))&&o.unshift(a[0],a[1]),(a=this._project(o[o.length-2],o[o.length-1],s,l))&&o.push(a[0],a[1]),o=this._clipFinite(e,o))for(let d=0,c=o.length,h,g=this._edgecode(o[c-2],o[c-1]);d<c;d+=2)h=g,g=this._edgecode(o[d],o[d+1]),h&&g&&(d=this._edge(e,h,g,o,d),c=o.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return o}_edge(e,i,r,n,s){for(;i!==r;){let l,o;switch(i){case 5:i=4;continue;case 4:i=6,l=this.xmax,o=this.ymin;break;case 6:i=2;continue;case 2:i=10,l=this.xmax,o=this.ymax;break;case 10:i=8;continue;case 8:i=9,l=this.xmin,o=this.ymax;break;case 9:i=1;continue;case 1:i=5,l=this.xmin,o=this.ymin;break}(n[s]!==l||n[s+1]!==o)&&this.contains(e,l,o)&&(n.splice(s,0,l,o),s+=2)}if(n.length>4)for(let l=0;l<n.length;l+=2){const o=(l+2)%n.length,a=(l+4)%n.length;(n[l]===n[o]&&n[o]===n[a]||n[l+1]===n[o+1]&&n[o+1]===n[a+1])&&(n.splice(o,2),l-=2)}return s}_project(e,i,r,n){let s=1/0,l,o,a;if(n<0){if(i<=this.ymin)return null;(l=(this.ymin-i)/n)<s&&(a=this.ymin,o=e+(s=l)*r)}else if(n>0){if(i>=this.ymax)return null;(l=(this.ymax-i)/n)<s&&(a=this.ymax,o=e+(s=l)*r)}if(r>0){if(e>=this.xmax)return null;(l=(this.xmax-e)/r)<s&&(o=this.xmax,a=i+(s=l)*n)}else if(r<0){if(e<=this.xmin)return null;(l=(this.xmin-e)/r)<s&&(o=this.xmin,a=i+(s=l)*n)}return[o,a]}_edgecode(e,i){return(e===this.xmin?1:e===this.xmax?2:0)|(i===this.ymin?4:i===this.ymax?8:0)}_regioncode(e,i){return(e<this.xmin?1:e>this.xmax?2:0)|(i<this.ymin?4:i>this.ymax?8:0)}}const $i=2*Math.PI,Me=Math.pow;function Di(t){return t[0]}function Gi(t){return t[1]}function Yi(t){const{triangles:e,coords:i}=t;for(let r=0;r<e.length;r+=3){const n=2*e[r],s=2*e[r+1],l=2*e[r+2];if((i[l]-i[n])*(i[s+1]-i[n+1])-(i[s]-i[n])*(i[l+1]-i[n+1])>1e-10)return!1}return!0}function zi(t,e,i){return[t+Math.sin(t+e)*i,e+Math.cos(t-e)*i]}class Ze{static from(e,i=Di,r=Gi,n){return new Ze("length"in e?Vi(e,i,r,n):Float64Array.from(Xi(e,i,r,n)))}constructor(e){this._delaunator=new Ie(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,i=this.points;if(e.hull&&e.hull.length>2&&Yi(e)){this.collinear=Int32Array.from({length:i.length/2},(g,f)=>f).sort((g,f)=>i[2*g]-i[2*f]||i[2*g+1]-i[2*f+1]);const a=this.collinear[0],d=this.collinear[this.collinear.length-1],c=[i[2*a],i[2*a+1],i[2*d],i[2*d+1]],h=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let g=0,f=i.length/2;g<f;++g){const m=zi(i[2*g],i[2*g+1],h);i[2*g]=m[0],i[2*g+1]=m[1]}this._delaunator=new Ie(i)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,n=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,l=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let a=0,d=r.length;a<d;++a){const c=s[a%3===2?a-2:a+1];(r[a]===-1||l[c]===-1)&&(l[c]=a)}for(let a=0,d=n.length;a<d;++a)o[n[a]]=a;n.length<=2&&n.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=n[0],this.triangles[1]=n[1],this.triangles[2]=n[1],l[n[0]]=1,n.length===2&&(l[n[1]]=0))}voronoi(e){return new Fi(this,e)}*neighbors(e){const{inedges:i,hull:r,_hullIndex:n,halfedges:s,triangles:l,collinear:o}=this;if(o){const h=o.indexOf(e);h>0&&(yield o[h-1]),h<o.length-1&&(yield o[h+1]);return}const a=i[e];if(a===-1)return;let d=a,c=-1;do{if(yield c=l[d],d=d%3===2?d-2:d+1,l[d]!==e)return;if(d=s[d],d===-1){const h=r[(n[e]+1)%r.length];h!==c&&(yield h);return}}while(d!==a)}find(e,i,r=0){if(e=+e,e!==e||(i=+i,i!==i))return-1;const n=r;let s;for(;(s=this._step(r,e,i))>=0&&s!==r&&s!==n;)r=s;return s}_step(e,i,r){const{inedges:n,hull:s,_hullIndex:l,halfedges:o,triangles:a,points:d}=this;if(n[e]===-1||!d.length)return(e+1)%(d.length>>1);let c=e,h=Me(i-d[e*2],2)+Me(r-d[e*2+1],2);const g=n[e];let f=g;do{let m=a[f];const p=Me(i-d[m*2],2)+Me(r-d[m*2+1],2);if(p<h&&(h=p,c=m),f=f%3===2?f-2:f+1,a[f]!==e)break;if(f=o[f],f===-1){if(f=s[(l[e]+1)%s.length],f!==m&&Me(i-d[f*2],2)+Me(r-d[f*2+1],2)<h)return f;break}}while(f!==g);return c}render(e){const i=e==null?e=new xe:void 0,{points:r,halfedges:n,triangles:s}=this;for(let l=0,o=n.length;l<o;++l){const a=n[l];if(a<l)continue;const d=s[l]*2,c=s[a]*2;e.moveTo(r[d],r[d+1]),e.lineTo(r[c],r[c+1])}return this.renderHull(e),i&&i.value()}renderPoints(e,i=2){const r=e==null?e=new xe:void 0,{points:n}=this;for(let s=0,l=n.length;s<l;s+=2){const o=n[s],a=n[s+1];e.moveTo(o+i,a),e.arc(o,a,i,0,$i)}return r&&r.value()}renderHull(e){const i=e==null?e=new xe:void 0,{hull:r,points:n}=this,s=r[0]*2,l=r.length;e.moveTo(n[s],n[s+1]);for(let o=1;o<l;++o){const a=2*r[o];e.lineTo(n[a],n[a+1])}return e.closePath(),i&&i.value()}hullPolygon(){const e=new Xe;return this.renderHull(e),e.value()}renderTriangle(e,i){const r=i==null?i=new xe:void 0,{points:n,triangles:s}=this,l=s[e*=3]*2,o=s[e+1]*2,a=s[e+2]*2;return i.moveTo(n[l],n[l+1]),i.lineTo(n[o],n[o+1]),i.lineTo(n[a],n[a+1]),i.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:e}=this;for(let i=0,r=e.length/3;i<r;++i)yield this.trianglePolygon(i)}trianglePolygon(e){const i=new Xe;return this.renderTriangle(e,i),i.value()}}function Vi(t,e,i,r){const n=t.length,s=new Float64Array(n*2);for(let l=0;l<n;++l){const o=t[l];s[l*2]=e.call(r,o,l,t),s[l*2+1]=i.call(r,o,l,t)}return s}function*Xi(t,e,i,r){let n=0;for(const s of t)yield e.call(r,s,n,t),yield i.call(r,s,n,t),++n}var ct=function(t){return typeof t=="function"?t:function(e){return e[t]}},Hi=function(t){var e=t.points,i=t.x,r=i===void 0?"x":i,n=t.y,s=n===void 0?"y":n,l=ct(r),o=ct(s);return e.map(function(a){return[l(a),o(a)]})},Ui=function(t){var e=t.points,i=t.width,r=t.height,n=t.debug,s=Ze.from(e),l=n?s.voronoi([0,0,i,r]):void 0;return{delaunay:s,voronoi:l}},kt=function(t){var e=t.points,i=t.x,r=t.y,n=t.width,s=t.height,l=t.debug,o=v.useMemo(function(){return Hi({points:e,x:i,y:r})},[e,i,r]);return v.useMemo(function(){return Ui({points:o,width:n,height:s,debug:l})},[o,n,s,l])},Ki=function(t){var e=t.nodes,i=t.width,r=t.height,n=t.x,s=t.y,l=t.onMouseEnter,o=t.onMouseMove,a=t.onMouseLeave,d=t.onClick,c=t.debug,h=v.useRef(null),g=v.useState(null),f=g[0],m=g[1],p=kt({points:e,x:n,y:s,width:i,height:r,debug:c}),_=p.delaunay,w=p.voronoi,k=v.useMemo(function(){if(c&&w)return w.render()},[c,w]),x=v.useCallback(function(T){if(!h.current)return[null,null];var R=mt(h.current,T),b=R[0],M=R[1],j=_.find(b,M);return[j,j!==void 0?e[j]:null]},[h,_]),O=v.useCallback(function(T){var R=x(T),b=R[0],M=R[1];m(b),M&&(l==null||l(M,T))},[x,m,l]),W=v.useCallback(function(T){var R=x(T),b=R[0],M=R[1];m(b),M&&(o==null||o(M,T))},[x,m,o]),F=v.useCallback(function(T){if(m(null),a){var R=void 0;f!==null&&(R=e[f]),R&&a(R,T)}},[m,f,a,e]),A=v.useCallback(function(T){var R=x(T),b=R[0],M=R[1];m(b),M&&(d==null||d(M,T))},[x,m,d]);return y.jsxs("g",{ref:h,children:[c&&w&&y.jsxs(y.Fragment,{children:[y.jsx("path",{d:k,stroke:"red",strokeWidth:1,opacity:.75}),f!==null&&y.jsx("path",{fill:"pink",opacity:.35,d:w.renderCell(f)})]}),y.jsx("rect",{width:i,height:r,fill:"red",opacity:0,style:{cursor:"auto"},onMouseEnter:O,onMouseMove:W,onMouseLeave:F,onClick:A})]})},Ni=function(t,e){t.save(),t.globalAlpha=.75,t.beginPath(),e.render(t),t.strokeStyle="red",t.lineWidth=1,t.stroke(),t.restore()},Qi=function(t,e,i){t.save(),t.globalAlpha=.35,t.beginPath(),e.renderCell(i,t),t.fillStyle="red",t.fill(),t.restore()};function X(){return X=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},X.apply(this,arguments)}var Ct=function(t){var e=t.point;return y.jsx(ti,{id:y.jsxs("span",{children:["x: ",y.jsx("strong",{children:e.data.xFormatted}),", y:"," ",y.jsx("strong",{children:e.data.yFormatted})]}),enableChip:!0,color:e.serieColor})};Ct.propTypes={point:u.object.isRequired};var Zi=v.memo(Ct),Tt=function(t){var e=t.slice,i=t.axis,r=Re(),n=i==="x"?"y":"x";return y.jsx(ii,{rows:e.points.map(function(s){return[y.jsx(ni,{color:s.serieColor,style:r.tooltip.chip},"chip"),s.serieId,y.jsx("span",{style:r.tooltip.tableCellValue,children:s.data[n+"Formatted"]},"value")]})})};Tt.propTypes={slice:u.object.isRequired,axis:u.oneOf(["x","y"]).isRequired};var Ji=v.memo(Tt),Rt={data:u.arrayOf(u.shape({id:u.oneOfType([u.string,u.number]).isRequired,data:u.arrayOf(u.shape({x:u.oneOfType([u.number,u.string,u.instanceOf(Date)]),y:u.oneOfType([u.number,u.string,u.instanceOf(Date)])})).isRequired})).isRequired,xScale:u.object.isRequired,xFormat:u.oneOfType([u.func,u.string]),yScale:u.object.isRequired,yFormat:u.oneOfType([u.func,u.string]),layers:u.arrayOf(u.oneOfType([u.oneOf(["grid","markers","axes","areas","crosshair","lines","slices","points","mesh","legends"]),u.func])).isRequired,curve:Zt.isRequired,axisTop:Le,axisRight:Le,axisBottom:Le,axisLeft:Le,enableGridX:u.bool.isRequired,enableGridY:u.bool.isRequired,gridXValues:u.oneOfType([u.number,u.arrayOf(u.oneOfType([u.number,u.string,u.instanceOf(Date)]))]),gridYValues:u.oneOfType([u.number,u.arrayOf(u.oneOfType([u.number,u.string,u.instanceOf(Date)]))]),enablePoints:u.bool.isRequired,pointSymbol:u.func,pointSize:u.number.isRequired,pointColor:u.any.isRequired,pointBorderWidth:u.number.isRequired,pointBorderColor:u.any.isRequired,enablePointLabel:u.bool.isRequired,pointLabel:u.oneOfType([u.string,u.func]).isRequired,markers:u.arrayOf(u.shape({axis:u.oneOf(["x","y"]).isRequired,value:u.oneOfType([u.number,u.string,u.instanceOf(Date)]).isRequired,style:u.object})),colors:Jt.isRequired,enableArea:u.bool.isRequired,areaOpacity:u.number.isRequired,areaBlendMode:Ke.isRequired,areaBaselineValue:u.oneOfType([u.number,u.string,u.instanceOf(Date)]).isRequired,lineWidth:u.number.isRequired,legends:u.arrayOf(u.shape(ei)).isRequired,isInteractive:u.bool.isRequired,debugMesh:u.bool.isRequired,tooltip:u.oneOfType([u.func,u.object]).isRequired,enableSlices:u.oneOf(["x","y",!1]).isRequired,debugSlices:u.bool.isRequired,sliceTooltip:u.oneOfType([u.func,u.object]).isRequired,enableCrosshair:u.bool.isRequired,crosshairType:u.string.isRequired},en=X({},Rt,{enablePointLabel:u.bool.isRequired,role:u.string.isRequired,useMesh:u.bool.isRequired},ri,si),tn=X({pixelRatio:u.number.isRequired},Rt),jt={curve:"linear",xScale:{type:"point"},yScale:{type:"linear",min:0,max:"auto"},layers:["grid","markers","axes","areas","crosshair","lines","points","slices","mesh","legends"],axisBottom:{},axisLeft:{},enableGridX:!0,enableGridY:!0,enablePoints:!0,pointSize:6,pointColor:{from:"color"},pointBorderWidth:0,pointBorderColor:{theme:"background"},enablePointLabel:!1,pointLabel:"yFormatted",colors:{scheme:"nivo"},enableArea:!1,areaBaselineValue:0,areaOpacity:.2,areaBlendMode:"normal",lineWidth:2,legends:[],isInteractive:!0,tooltip:Zi,enableSlices:!1,debugSlices:!1,sliceTooltip:Ji,debugMesh:!1,enableCrosshair:!0,crosshairType:"bottom-left"},ae=X({},jt,{enablePointLabel:!1,useMesh:!1,animate:!0,motionConfig:"gentle",defs:[],fill:[],role:"img"}),nn=X({},jt,{pixelRatio:typeof window<"u"&&window.devicePixelRatio||1}),rn=function(t){var e=t.curve;return v.useMemo(function(){return wt().defined(function(i){return i.x!==null&&i.y!==null}).x(function(i){return i.x}).y(function(i){return i.y}).curve(vt(e))},[e])},sn=function(t){var e=t.curve,i=t.yScale,r=t.areaBaselineValue;return v.useMemo(function(){return Ei().defined(function(n){return n.x!==null&&n.y!==null}).x(function(n){return n.x}).y1(function(n){return n.y}).curve(vt(e)).y0(i(r))},[e,i,r])},on=function(t){var e=t.enableSlices,i=t.points,r=t.width,n=t.height;return v.useMemo(function(){if(e===!1)return[];if(e==="x"){var s=new Map;return i.forEach(function(o){o.data.x!==null&&o.data.y!==null&&(s.has(o.x)?s.get(o.x).push(o):s.set(o.x,[o]))}),Array.from(s.entries()).sort(function(o,a){return o[0]-a[0]}).map(function(o,a,d){var c,h=o[0],g=o[1],f=d[a-1],m=d[a+1];return{id:h,x0:c=f?h-(h-f[0])/2:h,x:h,y0:0,y:0,width:m?h-c+(m[0]-h)/2:r-c,height:n,points:g.reverse()}})}if(e==="y"){var l=new Map;return i.forEach(function(o){o.data.x!==null&&o.data.y!==null&&(l.has(o.y)?l.get(o.y).push(o):l.set(o.y,[o]))}),Array.from(l.entries()).sort(function(o,a){return o[0]-a[0]}).map(function(o,a,d){var c,h,g=o[0],f=o[1],m=d[a-1],p=d[a+1];return c=m?g-(g-m[0])/2:g,h=p?g-c+(p[0]-g)/2:n-c,{id:g,x0:0,x:0,y0:c,y:g,width:r,height:h,points:f.reverse()}})}},[e,i])},Ot=function(t){var e=t.data,i=t.xScale,r=i===void 0?ae.xScale:i,n=t.xFormat,s=t.yScale,l=s===void 0?ae.yScale:s,o=t.yFormat,a=t.width,d=t.height,c=t.colors,h=c===void 0?ae.colors:c,g=t.curve,f=g===void 0?ae.curve:g,m=t.areaBaselineValue,p=m===void 0?ae.areaBaselineValue:m,_=t.pointColor,w=_===void 0?ae.pointColor:_,k=t.pointBorderColor,x=k===void 0?ae.pointBorderColor:k,O=t.enableSlices,W=O===void 0?ae.enableSlicesTooltip:O,F=lt(n),A=lt(o),T=xi(h,"id"),R=Re(),b=Pe(w,R),M=Pe(x,R),j=v.useState([]),q=j[0],P=j[1],$=v.useMemo(function(){return _i(e.filter(function(B){return q.indexOf(B.id)===-1}),r,l,a,d)},[e,q,r,l,a,d]),G=$.xScale,C=$.yScale,E=$.series,U=v.useMemo(function(){var B=e.map(function(I){return{id:I.id,label:I.id,color:T(I)}}),V=B.map(function(I){return X({},E.find(function(H){return H.id===I.id}),{color:I.color})}).filter(function(I){return Boolean(I.id)});return{legendData:B.map(function(I){return X({},I,{hidden:!V.find(function(H){return H.id===I.id})})}).reverse(),series:V}},[e,E,T]),Y=U.legendData,z=U.series,ee=v.useCallback(function(B){P(function(V){return V.indexOf(B)>-1?V.filter(function(I){return I!==B}):[].concat(V,[B])})},[]),se=function(B){var V=B.series,I=B.getPointColor,H=B.getPointBorderColor,he=B.formatX,K=B.formatY;return v.useMemo(function(){return V.reduce(function(oe,Z){return[].concat(oe,Z.data.filter(function(N){return N.position.x!==null&&N.position.y!==null}).map(function(N,ue){var ie={id:Z.id+"."+ue,index:oe.length+ue,serieId:Z.id,serieColor:Z.color,x:N.position.x,y:N.position.y};return ie.color=I(Z),ie.borderColor=H(ie),ie.data=X({},N.data,{xFormatted:he(N.data.x),yFormatted:K(N.data.y)}),ie}))},[])},[V,I,H,he,K])}({series:z,getPointColor:b,getPointBorderColor:M,formatX:F,formatY:A}),te=on({enableSlices:W,points:se,width:a,height:d});return{legendData:Y,toggleSerie:ee,lineGenerator:rn({curve:f}),areaGenerator:sn({curve:f,yScale:C,areaBaselineValue:p}),getColor:T,series:z,xScale:G,yScale:C,slices:te,points:se}},qt=function(t){var e=t.areaBlendMode,i=t.areaOpacity,r=t.color,n=t.fill,s=t.path,l=ai(),o=l.animate,a=l.config,d=bt(s),c=ui({color:r,config:a,immediate:!o});return y.jsx(xt.path,{d,fill:n||c.color,fillOpacity:i,strokeWidth:0,style:{mixBlendMode:e}})};qt.propTypes={areaBlendMode:Ke.isRequired,areaOpacity:u.number.isRequired,color:u.string,fill:u.string,path:u.string.isRequired};var Et=function(t){var e=t.areaGenerator,i=t.areaOpacity,r=t.areaBlendMode,n=t.lines.slice(0).reverse();return y.jsx("g",{children:n.map(function(s){return y.jsx(qt,X({path:e(s.data.map(function(l){return l.position}))},X({areaOpacity:i,areaBlendMode:r},s)),s.id)})})};Et.propTypes={areaGenerator:u.func.isRequired,areaOpacity:u.number.isRequired,areaBlendMode:Ke.isRequired,lines:u.arrayOf(u.object).isRequired};var ln=v.memo(Et),Lt=function(t){var e=t.lineGenerator,i=t.points,r=t.color,n=t.thickness,s=v.useMemo(function(){return e(i)},[e,i]),l=bt(s);return y.jsx(xt.path,{d:l,fill:"none",strokeWidth:n,stroke:r})};Lt.propTypes={points:u.arrayOf(u.shape({x:u.oneOfType([u.string,u.number]),y:u.oneOfType([u.string,u.number])})),lineGenerator:u.func.isRequired,color:u.string.isRequired,thickness:u.number.isRequired};var an=v.memo(Lt),Bt=function(t){var e=t.lines,i=t.lineGenerator,r=t.lineWidth;return e.slice(0).reverse().map(function(n){var s=n.id,l=n.data,o=n.color;return y.jsx(an,{id:s,points:l.map(function(a){return a.position}),lineGenerator:i,color:o,thickness:r},s)})};Bt.propTypes={lines:u.arrayOf(u.shape({id:u.oneOfType([u.string,u.number]).isRequired,color:u.string.isRequired,data:u.arrayOf(u.shape({data:u.shape({x:u.oneOfType([u.string,u.number,u.instanceOf(Date)]),y:u.oneOfType([u.string,u.number,u.instanceOf(Date)])}).isRequired,position:u.shape({x:u.number,y:u.number}).isRequired})).isRequired})).isRequired,lineWidth:u.number.isRequired,lineGenerator:u.func.isRequired};var un=v.memo(Bt),At=function(t){var e=t.slice,i=t.axis,r=t.debug,n=t.tooltip,s=t.isCurrent,l=t.setCurrent,o=Ne(),a=o.showTooltipFromEvent,d=o.hideTooltip,c=v.useCallback(function(f){a(v.createElement(n,{slice:e,axis:i}),f,"right"),l(e)},[a,n,e]),h=v.useCallback(function(f){a(v.createElement(n,{slice:e,axis:i}),f,"right")},[a,n,e]),g=v.useCallback(function(){d(),l(null)},[d]);return y.jsx("rect",{x:e.x0,y:e.y0,width:e.width,height:e.height,stroke:"red",strokeWidth:r?1:0,strokeOpacity:.75,fill:"red",fillOpacity:s&&r?.35:0,onMouseEnter:c,onMouseMove:h,onMouseLeave:g})};At.propTypes={slice:u.object.isRequired,axis:u.oneOf(["x","y"]).isRequired,debug:u.bool.isRequired,height:u.number.isRequired,tooltip:u.oneOfType([u.func,u.object]),isCurrent:u.bool.isRequired,setCurrent:u.func.isRequired};var cn=v.memo(At),Pt=function(t){var e=t.slices,i=t.axis,r=t.debug,n=t.height,s=t.tooltip,l=t.current,o=t.setCurrent;return e.map(function(a){return y.jsx(cn,{slice:a,axis:i,debug:r,height:n,tooltip:s,setCurrent:o,isCurrent:l!==null&&l.id===a.id},a.id)})};Pt.propTypes={slices:u.arrayOf(u.shape({id:u.oneOfType([u.number,u.string,u.instanceOf(Date)]).isRequired,x:u.number.isRequired,y:u.number.isRequired,points:u.arrayOf(u.object).isRequired})).isRequired,axis:u.oneOf(["x","y"]).isRequired,debug:u.bool.isRequired,height:u.number.isRequired,tooltip:u.oneOfType([u.func,u.object]).isRequired,current:u.object,setCurrent:u.func.isRequired};var hn=v.memo(Pt),It=function(t){var e=t.points,i=t.symbol,r=t.size,n=t.borderWidth,s=t.enableLabel,l=t.label,o=t.labelYOffset,a=Re(),d=oi(l),c=e.slice(0).reverse().map(function(h){return{id:h.id,x:h.x,y:h.y,datum:h.data,fill:h.color,stroke:h.borderColor,label:s?d(h.data):null}});return y.jsx("g",{children:c.map(function(h){return y.jsx(li,{x:h.x,y:h.y,datum:h.datum,symbol:i,size:r,color:h.fill,borderWidth:n,borderColor:h.stroke,label:h.label,labelYOffset:o,theme:a},h.id)})})};It.propTypes={points:u.arrayOf(u.object),symbol:u.func,size:u.number.isRequired,color:u.func.isRequired,borderWidth:u.number.isRequired,borderColor:u.func.isRequired,enableLabel:u.bool.isRequired,label:u.oneOfType([u.string,u.func]).isRequired,labelYOffset:u.number};var dn=v.memo(It),Wt=function(t){var e=t.points,i=t.width,r=t.height,n=t.margin,s=t.setCurrent,l=t.onMouseEnter,o=t.onMouseMove,a=t.onMouseLeave,d=t.onClick,c=t.tooltip,h=t.debug,g=Ne(),f=g.showTooltipAt,m=g.hideTooltip,p=v.useCallback(function(x,O){f(v.createElement(c,{point:x}),[x.x+n.left,x.y+n.top],"top"),s(x),l&&l(x,O)},[s,f,c,l,n]),_=v.useCallback(function(x,O){f(v.createElement(c,{point:x}),[x.x+n.left,x.y+n.top],"top"),s(x),o&&o(x,O)},[s,f,c,o]),w=v.useCallback(function(x,O){m(),s(null),a&&a(x,O)},[m,s,a]),k=v.useCallback(function(x,O){d&&d(x,O)},[d]);return y.jsx(Ki,{nodes:e,width:i,height:r,onMouseEnter:p,onMouseMove:_,onMouseLeave:w,onClick:k,debug:h})};Wt.propTypes={points:u.arrayOf(u.object).isRequired,width:u.number.isRequired,height:u.number.isRequired,margin:u.object.isRequired,setCurrent:u.func.isRequired,onMouseEnter:u.func,onMouseMove:u.func,onMouseLeave:u.func,onClick:u.func,tooltip:u.oneOfType([u.func,u.object]).isRequired,debug:u.bool.isRequired};var fn=v.memo(Wt),He=function(t){var e=t.data,i=t.xScale,r=t.xFormat,n=t.yScale,s=t.yFormat,l=t.layers,o=t.curve,a=t.areaBaselineValue,d=t.colors,c=t.margin,h=t.width,g=t.height,f=t.axisTop,m=t.axisRight,p=t.axisBottom,_=t.axisLeft,w=t.enableGridX,k=t.enableGridY,x=t.gridXValues,O=t.gridYValues,W=t.lineWidth,F=t.enableArea,A=t.areaOpacity,T=t.areaBlendMode,R=t.enablePoints,b=t.pointSymbol,M=t.pointSize,j=t.pointColor,q=t.pointBorderWidth,P=t.pointBorderColor,$=t.enablePointLabel,G=t.pointLabel,C=t.pointLabelYOffset,E=t.defs,U=t.fill,Y=t.markers,z=t.legends,ee=t.isInteractive,se=t.useMesh,te=t.debugMesh,B=t.onMouseEnter,V=t.onMouseMove,I=t.onMouseLeave,H=t.onClick,he=t.tooltip,K=t.enableSlices,oe=t.debugSlices,Z=t.sliceTooltip,N=t.enableCrosshair,ue=t.crosshairType,ie=t.role,le=_t(h,g,c),de=le.margin,Q=le.innerWidth,ne=le.innerHeight,je=le.outerWidth,Oe=le.outerHeight,J=Ot({data:e,xScale:i,xFormat:r,yScale:n,yFormat:s,width:Q,height:ne,colors:d,curve:o,areaBaselineValue:a,pointColor:j,pointBorderColor:P,enableSlices:K}),qe=J.legendData,Ee=J.toggleSerie,fe=J.lineGenerator,we=J.areaGenerator,_e=J.series,ve=J.xScale,S=J.yScale,D=J.slices,ce=J.points,L=Re(),ge=Pe(j,L),Ft=Pe(P,L),Je=v.useState(null),ke=Je[0],et=Je[1],tt=v.useState(null),Ce=tt[0],it=tt[1],me={grid:y.jsx(ci,{theme:L,width:Q,height:ne,xScale:w?ve:null,yScale:k?S:null,xValues:x,yValues:O},"grid"),markers:y.jsx(hi,{markers:Y,width:Q,height:ne,xScale:ve,yScale:S,theme:L},"markers"),axes:y.jsx(di,{xScale:ve,yScale:S,width:Q,height:ne,theme:L,top:f,right:m,bottom:p,left:_},"axes"),areas:null,lines:y.jsx(un,{lines:_e,lineGenerator:fe,lineWidth:W},"lines"),slices:null,points:null,crosshair:null,mesh:null,legends:z.map(function(pe,We){return y.jsx(fi,X({},pe,{containerWidth:Q,containerHeight:ne,data:pe.data||qe,theme:L,toggleSerie:pe.toggleSerie?Ee:void 0}),"legend."+We)})},$t=gi(E,_e,U);return F&&(me.areas=y.jsx(ln,{areaGenerator:we,areaOpacity:A,areaBlendMode:T,lines:_e},"areas")),ee&&K!==!1&&(me.slices=y.jsx(hn,{slices:D,axis:K,debug:oe,height:ne,tooltip:Z,current:Ce,setCurrent:it},"slices")),R&&(me.points=y.jsx(dn,{points:ce,symbol:b,size:M,color:ge,borderWidth:q,borderColor:Ft,enableLabel:$,label:G,labelYOffset:C},"points")),ee&&N&&(ke!==null&&(me.crosshair=y.jsx(st,{width:Q,height:ne,x:ke.x,y:ke.y,type:ue},"crosshair")),Ce!==null&&(me.crosshair=y.jsx(st,{width:Q,height:ne,x:Ce.x,y:Ce.y,type:K},"crosshair"))),ee&&se&&K===!1&&(me.mesh=y.jsx(fn,{points:ce,width:Q,height:ne,margin:de,current:ke,setCurrent:et,onMouseEnter:B,onMouseMove:V,onMouseLeave:I,onClick:H,tooltip:he,debug:te},"mesh")),y.jsx(mi,{defs:$t,width:je,height:Oe,margin:de,role:ie,children:l.map(function(pe,We){return typeof pe=="function"?y.jsx(v.Fragment,{children:pe(X({},t,{innerWidth:Q,innerHeight:ne,series:_e,slices:D,points:ce,xScale:ve,yScale:S,lineGenerator:fe,areaGenerator:we,currentPoint:ke,setCurrentPoint:et,currentSlice:Ce,setCurrentSlice:it}))},We):me[pe]})})};He.propTypes=en,He.defaultProps=ae;var gn=pt(He),mn=function(t){return y.jsx(yt,{children:function(e){var i=e.width,r=e.height;return y.jsx(gn,X({width:i,height:r},t))}})},Ue=function(t){var e=t.width,i=t.height,r=t.margin,n=t.pixelRatio,s=t.data,l=t.xScale,o=t.xFormat,a=t.yScale,d=t.yFormat,c=t.curve,h=t.layers,g=t.colors,f=t.lineWidth,m=t.enableArea,p=t.areaBaselineValue,_=t.areaOpacity,w=t.enablePoints,k=t.pointSize,x=t.pointColor,O=t.pointBorderWidth,W=t.pointBorderColor,F=t.enableGridX,A=t.gridXValues,T=t.enableGridY,R=t.gridYValues,b=t.axisTop,M=t.axisRight,j=t.axisBottom,q=t.axisLeft,P=t.legends,$=t.isInteractive,G=t.debugMesh,C=t.onMouseLeave,E=t.onClick,U=t.tooltip,Y=t.canvasRef,z=v.useRef(null),ee=_t(e,i,r),se=ee.margin,te=ee.innerWidth,B=ee.innerHeight,V=ee.outerWidth,I=ee.outerHeight,H=Re(),he=v.useState(null),K=he[0],oe=he[1],Z=Ot({data:s,xScale:l,xFormat:o,yScale:a,yFormat:d,width:te,height:B,colors:g,curve:c,areaBaselineValue:p,pointColor:x,pointBorderColor:W}),N=Z.lineGenerator,ue=Z.areaGenerator,ie=Z.series,le=Z.xScale,de=Z.yScale,Q=Z.points,ne=kt({points:Q,width:te,height:B,debug:G}),je=ne.delaunay,Oe=ne.voronoi;v.useEffect(function(){Y&&(Y.current=z.current),z.current.width=V*n,z.current.height=I*n;var S=z.current.getContext("2d");S.scale(n,n),S.fillStyle=H.background,S.fillRect(0,0,V,I),S.translate(se.left,se.top),h.forEach(function(D){if(typeof D=="function"&&D({ctx:S,innerWidth:te,innerHeight:B,series:ie,points:Q,xScale:le,yScale:de,lineWidth:f,lineGenerator:N,areaGenerator:ue,currentPoint:K,setCurrentPoint:oe}),D==="grid"&&H.grid.line.strokeWidth>0&&(S.lineWidth=H.grid.line.strokeWidth,S.strokeStyle=H.grid.line.stroke,F&&ot(S,{width:te,height:B,scale:le,axis:"x",values:A}),T&&ot(S,{width:te,height:B,scale:de,axis:"y",values:R})),D==="axes"&&pi(S,{xScale:le,yScale:de,width:te,height:B,top:b,right:M,bottom:j,left:q,theme:H}),D==="areas"&&m===!0&&(S.save(),S.globalAlpha=_,ue.context(S),ie.forEach(function(L){S.fillStyle=L.color,S.beginPath(),ue(L.data.map(function(ge){return ge.position})),S.fill()}),S.restore()),D==="lines"&&(N.context(S),ie.forEach(function(L){S.strokeStyle=L.color,S.lineWidth=f,S.beginPath(),N(L.data.map(function(ge){return ge.position})),S.stroke()})),D==="points"&&w===!0&&k>0&&Q.forEach(function(L){S.fillStyle=L.color,S.beginPath(),S.arc(L.x,L.y,k/2,0,2*Math.PI),S.fill(),O>0&&(S.strokeStyle=L.borderColor,S.lineWidth=O,S.stroke())}),D==="mesh"&&G===!0&&(Ni(S,Oe),K&&Qi(S,Oe,K.index)),D==="legends"){var ce=ie.map(function(L){return{id:L.id,label:L.id,color:L.color}}).reverse();P.forEach(function(L){yi(S,X({},L,{data:L.data||ce,containerWidth:te,containerHeight:B,theme:H}))})}})},[z,V,I,h,H,N,ie,le,de,F,A,T,R,b,M,j,q,P,Q,w,k,K]);var J=v.useCallback(function(S){var D=mt(z.current,S),ce=D[0],L=D[1];if(!bi(se.left,se.top,te,B,ce,L))return null;var ge=je.find(ce-se.left,L-se.top);return Q[ge]},[z,se,te,B,je]),qe=Ne(),Ee=qe.showTooltipFromEvent,fe=qe.hideTooltip,we=v.useCallback(function(S){var D=J(S);oe(D),D?Ee(v.createElement(U,{point:D}),S):fe()},[J,oe,Ee,fe,U]),_e=v.useCallback(function(S){fe(),oe(null),K&&C&&C(K,S)},[fe,oe,C]),ve=v.useCallback(function(S){if(E){var D=J(S);D&&E(D,S)}},[J,E]);return y.jsx("canvas",{ref:z,width:V*n,height:I*n,style:{width:V,height:I,cursor:$?"auto":"normal"},onMouseEnter:$?we:void 0,onMouseMove:$?we:void 0,onMouseLeave:$?_e:void 0,onClick:$?ve:void 0})};Ue.propTypes=tn,Ue.defaultProps=nn;var pn=pt(Ue),yn=v.forwardRef(function(t,e){return y.jsx(pn,X({},t,{canvasRef:e}))});v.forwardRef(function(t,e){return y.jsx(yt,{children:function(i){var r=i.width,n=i.height;return y.jsx(yn,X({width:r,height:n},t,{ref:e}))}})});be.extend(Ti);function bn({data:t,timeUnit:e,height:i=260,enableLeftTicks:r,enableBottomTicks:n}){const s=zt();return y.jsx(ht,{pt:"md",sx:{height:i,width:"100%"},children:!!t[0].data.length&&y.jsx(mn,{data:t,margin:{top:6,right:12,bottom:n?28:6,left:r?56:12},xScale:{type:"time",format:e==="day"?"%Y-%m-%d":"%b",useUTC:!1,precision:e},xFormat:`time:${e==="day"?"%Y-%m-%d":"%b"}`,yScale:{type:"linear"},axisLeft:{tickPadding:10,tickValues:2},axisBottom:{format:e==="day"?"%e":"%b",tickPadding:10,tickValues:`every ${e}`},curve:"monotoneX",defs:[vi("gradient",[{offset:0,color:"inherit"},{offset:100,color:"inherit",opacity:0}])],areaOpacity:s.colorScheme==="dark"?.25:.5,fill:[{match:"*",id:"gradient"}],theme:{textColor:s.colorScheme==="dark"?s.colors.dark[2]:s.colors.gray[6],fontSize:12,axis:{ticks:{line:{strokeWidth:0}}},crosshair:{line:{stroke:s.colorScheme==="dark"?s.colors.dark[1]:s.colors.gray[7]}}},sliceTooltip:({slice:l})=>y.jsx(Vt,{p:"sm",bg:s.colorScheme==="dark"?s.colors.dark[8]:s.colors.gray[1],shadow:s.shadows.md,children:l.points.map(o=>y.jsxs(ft,{spacing:"sm",children:[y.jsx(Xt,{size:14,color:o.serieColor}),y.jsx(nt,{size:"sm",color:"dimmed",inline:!0,children:e==="day"?be(o.data.xFormatted).format("dddd, D MMM"):be(o.data.xFormatted,"MMM").format("MMMM YYYY")}),y.jsxs(nt,{size:"sm",weight:"bold",inline:!0,children:["$",o.data.yFormatted]})]},o.id))}),colors:[s.colors[s.primaryColor][5]],enableGridX:!1,enableGridY:!1,pointSize:8,pointBorderWidth:2,pointLabelYOffset:-12,enableArea:!0,enableSlices:"x",useMesh:!0,motionConfig:"default"})})}function Tn({visibleNumbers:t}){const[e,i]=Ht({key:"earnings-filters",defaultValue:{timeframe:"week",excludedDays:["0"],enableLeftTicks:!1,enableBottomTicks:!0},getInitialValueInEffect:!1}),r=p=>{i(_=>({..._,...p}))},[n,s]=v.useState([null,null]),[l,o]=e.timeframe==="custom"?n.map(p=>be(p)):[be().startOf(e.timeframe),be()],a=[Fe("status","==","delivered"),Fe("deliveredTimestamp",">=",l.valueOf())];e.timeframe==="custom"&&a.push(Fe("deliveredTimestamp","<=",o.endOf("day").valueOf()));const d=Ut(Kt,...a),[c]=Nt(d),{data:h,timeUnit:g,totalEarnings:f,orderCount:m}=v.useMemo(()=>{const{timeframe:p}=e,_=e.excludedDays.map(W=>+W),w=[];let k="day",x=0,O=0;if(c){const W={},F=p==="year"?"MMM":"YYYY-MM-DD";k=p==="year"?"month":"day";for(let A=0;A<=o.diff(l,k);A++){const T=l.add(A,k),R=T.format(F);(p==="year"||!_.includes(T.day()))&&(W[R]=0)}c.forEach(A=>{const T=be(A.deliveredTimestamp),R=T.format(F);_.includes(T.day())||(W[R]+=A.price,O++)}),Object.entries(W).forEach(([A,T])=>{w.push({x:A,y:T}),x+=T})}return{data:w,timeUnit:k,totalEarnings:x,orderCount:O}},[e.excludedDays,c]);return y.jsxs(Ge,{children:[y.jsx(Qt,{in:!!c,style:{minHeight:336},children:y.jsxs(Ge,{spacing:0,children:[y.jsx(Mi,{items:[{text:t?`$${f.toLocaleString()}`:"*****",sub:"Total"},{text:m,sub:"Orders"}]}),y.jsx(dt,{in:t&&h.length>1,children:y.jsx(bn,{data:[{id:"Earnings",data:h}],timeUnit:g,enableLeftTicks:e.enableLeftTicks,enableBottomTicks:e.enableBottomTicks})})]})}),y.jsx(Oi,{filters:e,updateFilter:r,dateRange:n,setDateRange:s})]})}export{Tn as default};
