import{j as v,a8 as dt,a6 as Ae,aA as ft,aP as It,aJ as Gt,G as mt,N as zt,af as Vt,r as S,u as Xt,aQ as Ht,ay as Ut,T as rt,t as Zt,z as Fe,v as Kt,C as Nt}from"./index-5e2edfad.js";import{u as Qt,L as Jt}from"./useCollectionDataPersistent-d403fc62.js";import{c as oe,d as gt,Q as pt,p as u,R as en,w as Ye,X as tn,M as Ke,T as nn,F as yt,t as bt,a as rn,V as je,C as sn,b as on,e as an,k as ln,i as xt,f as vt,g as Ne,E as un,h as cn,j as hn,u as dn,A as _t,W as $e,B as fn,l as mn,m as gn,n as pn,r as yn,P as st,S as bn,o as ot,q as xn,H as vn,J as _n,s as at,v as Mn,x as wn,y as Mt,z as Sn,O as kn}from"./nivo-legends.es-0bf0299d.js";import{M as Tn,d as be}from"./dayjs.min-8f86dd78.js";import{a as Cn,g as jn}from"./TimeRangeInput-912cba1d.js";import{L as Rn}from"./LabeledSegmentedControl-41c67f9f.js";import{C as lt}from"./Checkbox-8756c2b7.js";const On=zt(t=>({grid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:t.spacing.sm}})),qn=["Week","Month","Year","Custom"];function Ln({filters:t,updateFilter:e,dateRange:n,setDateRange:o}){const{classes:i}=On();return v.jsxs(dt,{className:i.grid,children:[v.jsxs(Ae,{spacing:0,children:[v.jsx(Rn,{label:"Timeframe",data:qn.map(r=>({label:r,value:r.toLowerCase()})),value:t.timeframe,onChange:r=>e({timeframe:r})}),v.jsx(ft,{in:t.timeframe==="custom",children:v.jsx(Cn,{icon:v.jsx(It,{}),placeholder:"Select dates range",firstDayOfWeek:"sunday",initialLevel:"month",pt:"md",value:n,onChange:o})})]}),v.jsxs(Ae,{children:[v.jsx(Tn,{label:"Exclude",data:jn("en","sunday","dddd").map((r,a)=>({label:r,value:a.toString()})),icon:v.jsx(Gt,{}),placeholder:"Select days",value:t.excludedDays,onChange:r=>e({excludedDays:r})}),v.jsxs(mt,{children:[v.jsx(lt,{checked:t.enableLeftTicks,label:"Enable left ticks",onChange:({target:{checked:r}})=>e({enableLeftTicks:r})}),v.jsx(lt,{checked:t.enableBottomTicks,label:"Enable bottom ticks",onChange:({target:{checked:r}})=>e({enableBottomTicks:r})})]})]})]})}var Ge={},Yn={get exports(){return Ge},set exports(t){Ge=t}};(function(t,e){(function(n,o){t.exports=o()})(Vt,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},o=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d\d/,r=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,s={},l=function(f){return(f=+f)+(f>68?1900:2e3)},h=function(f){return function(y){this[f]=+y}},c=[/[+-]\d\d:?(\d\d)?|Z/,function(f){(this.zone||(this.zone={})).offset=function(y){if(!y||y==="Z")return 0;var x=y.match(/([+-]|\d\d)/g),_=60*x[1]+(+x[2]||0);return _===0?0:x[0]==="+"?-_:_}(f)}],d=function(f){var y=s[f];return y&&(y.indexOf?y:y.s.concat(y.f))},g=function(f,y){var x,_=s.meridiem;if(_){for(var M=1;M<=24;M+=1)if(f.indexOf(_(M,0,y))>-1){x=M>12;break}}else x=f===(y?"pm":"PM");return x},m={A:[a,function(f){this.afternoon=g(f,!1)}],a:[a,function(f){this.afternoon=g(f,!0)}],S:[/\d/,function(f){this.milliseconds=100*+f}],SS:[i,function(f){this.milliseconds=10*+f}],SSS:[/\d{3}/,function(f){this.milliseconds=+f}],s:[r,h("seconds")],ss:[r,h("seconds")],m:[r,h("minutes")],mm:[r,h("minutes")],H:[r,h("hours")],h:[r,h("hours")],HH:[r,h("hours")],hh:[r,h("hours")],D:[r,h("day")],DD:[i,h("day")],Do:[a,function(f){var y=s.ordinal,x=f.match(/\d+/);if(this.day=x[0],y)for(var _=1;_<=31;_+=1)y(_).replace(/\[|\]/g,"")===f&&(this.day=_)}],M:[r,h("month")],MM:[i,h("month")],MMM:[a,function(f){var y=d("months"),x=(d("monthsShort")||y.map(function(_){return _.slice(0,3)})).indexOf(f)+1;if(x<1)throw new Error;this.month=x%12||x}],MMMM:[a,function(f){var y=d("months").indexOf(f)+1;if(y<1)throw new Error;this.month=y%12||y}],Y:[/[+-]?\d+/,h("year")],YY:[i,function(f){this.year=l(f)}],YYYY:[/\d{4}/,h("year")],Z:c,ZZ:c};function p(f){var y,x;y=f,x=s&&s.formats;for(var _=(f=y.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(R,b,w){var k=w&&w.toUpperCase();return b||x[w]||n[w]||x[k].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(q,E,A){return E||A.slice(1)})})).match(o),M=_.length,O=0;O<M;O+=1){var $=_[O],D=m[$],Y=D&&D[0],T=D&&D[1];_[O]=T?{regex:Y,parser:T}:$.replace(/^\[|\]$/g,"")}return function(R){for(var b={},w=0,k=0;w<M;w+=1){var q=_[w];if(typeof q=="string")k+=q.length;else{var E=q.regex,A=q.parser,I=R.slice(k),j=E.exec(I)[0];A.call(b,j),R=R.replace(j,"")}}return function(L){var B=L.afternoon;if(B!==void 0){var G=L.hours;B?G<12&&(L.hours+=12):G===12&&(L.hours=0),delete L.afternoon}}(b),b}}return function(f,y,x){x.p.customParseFormat=!0,f&&f.parseTwoDigitYear&&(l=f.parseTwoDigitYear);var _=y.prototype,M=_.parse;_.parse=function(O){var $=O.date,D=O.utc,Y=O.args;this.$u=D;var T=Y[1];if(typeof T=="string"){var R=Y[2]===!0,b=Y[3]===!0,w=R||b,k=Y[2];b&&(k=Y[2]),s=this.$locale(),!R&&k&&(s=x.Ls[k]),this.$d=function(I,j,L){try{if(["x","X"].indexOf(j)>-1)return new Date((j==="X"?1e3:1)*I);var B=p(j)(I),G=B.year,z=B.month,J=B.day,ie=B.hours,ee=B.minutes,P=B.seconds,H=B.milliseconds,F=B.zone,X=new Date,le=J||(G||z?1:X.getDate()),U=G||X.getFullYear(),te=0;G&&!z||(te=z>0?z-1:X.getMonth());var K=ie||0,Z=ee||0,ae=P||0,N=H||0;return F?new Date(Date.UTC(U,te,le,K,Z,ae,N+60*F.offset*1e3)):L?new Date(Date.UTC(U,te,le,K,Z,ae,N)):new Date(U,te,le,K,Z,ae,N)}catch{return new Date("")}}($,T,D),this.init(),k&&k!==!0&&(this.$L=this.locale(k).$L),w&&$!=this.format(T)&&(this.$d=new Date("")),s={}}else if(T instanceof Array)for(var q=T.length,E=1;E<=q;E+=1){Y[1]=T[E-1];var A=x.apply(this,Y);if(A.isValid()){this.$d=A.$d,this.$L=A.$L,this.init();break}E===q&&(this.$d=new Date(""))}else M.call(this,O)}}})})(Yn);const En=Ge;var ze=Math.PI,Ve=2*ze,ye=1e-6,Dn=Ve-ye;function Xe(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Qe(){return new Xe}Xe.prototype=Qe.prototype={constructor:Xe,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,o){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+o)},bezierCurveTo:function(t,e,n,o,i,r){this._+="C"+ +t+","+ +e+","+ +n+","+ +o+","+(this._x1=+i)+","+(this._y1=+r)},arcTo:function(t,e,n,o,i){t=+t,e=+e,n=+n,o=+o,i=+i;var r=this._x1,a=this._y1,s=n-t,l=o-e,h=r-t,c=a-e,d=h*h+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(d>ye)if(!(Math.abs(c*s-l*h)>ye)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var g=n-r,m=o-a,p=s*s+l*l,f=g*g+m*m,y=Math.sqrt(p),x=Math.sqrt(d),_=i*Math.tan((ze-Math.acos((p+d-f)/(2*y*x)))/2),M=_/x,O=_/y;Math.abs(M-1)>ye&&(this._+="L"+(t+M*h)+","+(e+M*c)),this._+="A"+i+","+i+",0,0,"+ +(c*g>h*m)+","+(this._x1=t+O*s)+","+(this._y1=e+O*l)}},arc:function(t,e,n,o,i,r){t=+t,e=+e,n=+n,r=!!r;var a=n*Math.cos(o),s=n*Math.sin(o),l=t+a,h=e+s,c=1^r,d=r?o-i:i-o;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+l+","+h:(Math.abs(this._x1-l)>ye||Math.abs(this._y1-h)>ye)&&(this._+="L"+l+","+h),n&&(d<0&&(d=d%Ve+Ve),d>Dn?this._+="A"+n+","+n+",0,1,"+c+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=h):d>ye&&(this._+="A"+n+","+n+",0,"+ +(d>=ze)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,o){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +o+"h"+-n+"Z"},toString:function(){return this._}};function wt(t){return t[0]}function St(t){return t[1]}function kt(){var t=wt,e=St,n=oe(!0),o=null,i=gt,r=null;function a(s){var l,h=s.length,c,d=!1,g;for(o==null&&(r=i(g=Qe())),l=0;l<=h;++l)!(l<h&&n(c=s[l],l,s))===d&&((d=!d)?r.lineStart():r.lineEnd()),d&&r.point(+t(c,l,s),+e(c,l,s));if(g)return r=null,g+""||null}return a.x=function(s){return arguments.length?(t=typeof s=="function"?s:oe(+s),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:oe(+s),a):e},a.defined=function(s){return arguments.length?(n=typeof s=="function"?s:oe(!!s),a):n},a.curve=function(s){return arguments.length?(i=s,o!=null&&(r=i(o)),a):i},a.context=function(s){return arguments.length?(s==null?o=r=null:r=i(o=s),a):o},a}function An(){var t=wt,e=null,n=oe(0),o=St,i=oe(!0),r=null,a=gt,s=null;function l(c){var d,g,m,p=c.length,f,y=!1,x,_=new Array(p),M=new Array(p);for(r==null&&(s=a(x=Qe())),d=0;d<=p;++d){if(!(d<p&&i(f=c[d],d,c))===y)if(y=!y)g=d,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),m=d-1;m>=g;--m)s.point(_[m],M[m]);s.lineEnd(),s.areaEnd()}y&&(_[d]=+t(f,d,c),M[d]=+n(f,d,c),s.point(e?+e(f,d,c):_[d],o?+o(f,d,c):M[d]))}if(x)return s=null,x+""||null}function h(){return kt().defined(i).curve(a).context(r)}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:oe(+c),e=null,l):t},l.x0=function(c){return arguments.length?(t=typeof c=="function"?c:oe(+c),l):t},l.x1=function(c){return arguments.length?(e=c==null?null:typeof c=="function"?c:oe(+c),l):e},l.y=function(c){return arguments.length?(n=typeof c=="function"?c:oe(+c),o=null,l):n},l.y0=function(c){return arguments.length?(n=typeof c=="function"?c:oe(+c),l):n},l.y1=function(c){return arguments.length?(o=c==null?null:typeof c=="function"?c:oe(+c),l):o},l.lineX0=l.lineY0=function(){return h().x(t).y(n)},l.lineY1=function(){return h().x(t).y(o)},l.lineX1=function(){return h().x(e).y(n)},l.defined=function(c){return arguments.length?(i=typeof c=="function"?c:oe(!!c),l):i},l.curve=function(c){return arguments.length?(a=c,r!=null&&(s=a(r)),l):a},l.context=function(c){return arguments.length?(c==null?r=s=null:s=a(r=c),l):r},l}const ut=Math.pow(2,-52),Ee=new Uint32Array(512);class Pe{static from(e,n=Wn,o=In){const i=e.length,r=new Float64Array(i*2);for(let a=0;a<i;a++){const s=e[a];r[2*a]=n(s),r[2*a+1]=o(s)}return new Pe(r)}constructor(e){const n=e.length>>1;if(n>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const o=Math.max(2*n-5,0);this._triangles=new Uint32Array(o*3),this._halfedges=new Int32Array(o*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:e,_hullPrev:n,_hullNext:o,_hullTri:i,_hullHash:r}=this,a=e.length>>1;let s=1/0,l=1/0,h=-1/0,c=-1/0;for(let b=0;b<a;b++){const w=e[2*b],k=e[2*b+1];w<s&&(s=w),k<l&&(l=k),w>h&&(h=w),k>c&&(c=k),this._ids[b]=b}const d=(s+h)/2,g=(l+c)/2;let m=1/0,p,f,y;for(let b=0;b<a;b++){const w=We(d,g,e[2*b],e[2*b+1]);w<m&&(p=b,m=w)}const x=e[2*p],_=e[2*p+1];m=1/0;for(let b=0;b<a;b++){if(b===p)continue;const w=We(x,_,e[2*b],e[2*b+1]);w<m&&w>0&&(f=b,m=w)}let M=e[2*f],O=e[2*f+1],$=1/0;for(let b=0;b<a;b++){if(b===p||b===f)continue;const w=Bn(x,_,M,O,e[2*b],e[2*b+1]);w<$&&(y=b,$=w)}let D=e[2*y],Y=e[2*y+1];if($===1/0){for(let k=0;k<a;k++)this._dists[k]=e[2*k]-e[0]||e[2*k+1]-e[1];we(this._ids,this._dists,0,a-1);const b=new Uint32Array(a);let w=0;for(let k=0,q=-1/0;k<a;k++){const E=this._ids[k];this._dists[E]>q&&(b[w++]=E,q=this._dists[E])}this.hull=b.subarray(0,w),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(De(x,_,M,O,D,Y)){const b=f,w=M,k=O;f=y,M=D,O=Y,y=b,D=w,Y=k}const T=Fn(x,_,M,O,D,Y);this._cx=T.x,this._cy=T.y;for(let b=0;b<a;b++)this._dists[b]=We(e[2*b],e[2*b+1],T.x,T.y);we(this._ids,this._dists,0,a-1),this._hullStart=p;let R=3;o[p]=n[y]=f,o[f]=n[p]=y,o[y]=n[f]=p,i[p]=0,i[f]=1,i[y]=2,r.fill(-1),r[this._hashKey(x,_)]=p,r[this._hashKey(M,O)]=f,r[this._hashKey(D,Y)]=y,this.trianglesLen=0,this._addTriangle(p,f,y,-1,-1,-1);for(let b=0,w,k;b<this._ids.length;b++){const q=this._ids[b],E=e[2*q],A=e[2*q+1];if(b>0&&Math.abs(E-w)<=ut&&Math.abs(A-k)<=ut||(w=E,k=A,q===p||q===f||q===y))continue;let I=0;for(let z=0,J=this._hashKey(E,A);z<this._hashSize&&(I=r[(J+z)%this._hashSize],!(I!==-1&&I!==o[I]));z++);I=n[I];let j=I,L;for(;L=o[j],!De(E,A,e[2*j],e[2*j+1],e[2*L],e[2*L+1]);)if(j=L,j===I){j=-1;break}if(j===-1)continue;let B=this._addTriangle(j,q,o[j],-1,-1,i[j]);i[q]=this._legalize(B+2),i[j]=B,R++;let G=o[j];for(;L=o[G],De(E,A,e[2*G],e[2*G+1],e[2*L],e[2*L+1]);)B=this._addTriangle(G,q,L,i[q],-1,i[G]),i[q]=this._legalize(B+2),o[G]=G,R--,G=L;if(j===I)for(;L=n[j],De(E,A,e[2*L],e[2*L+1],e[2*j],e[2*j+1]);)B=this._addTriangle(L,q,j,-1,i[j],i[L]),this._legalize(B+2),i[L]=B,o[j]=j,R--,j=L;this._hullStart=n[q]=j,o[j]=n[G]=q,o[q]=G,r[this._hashKey(E,A)]=q,r[this._hashKey(e[2*j],e[2*j+1])]=j}this.hull=new Uint32Array(R);for(let b=0,w=this._hullStart;b<R;b++)this.hull[b]=w,w=o[w];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,n){return Math.floor($n(e-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:n,_halfedges:o,coords:i}=this;let r=0,a=0;for(;;){const s=o[e],l=e-e%3;if(a=l+(e+2)%3,s===-1){if(r===0)break;e=Ee[--r];continue}const h=s-s%3,c=l+(e+1)%3,d=h+(s+2)%3,g=n[a],m=n[e],p=n[c],f=n[d];if(Pn(i[2*g],i[2*g+1],i[2*m],i[2*m+1],i[2*p],i[2*p+1],i[2*f],i[2*f+1])){n[e]=f,n[s]=g;const x=o[d];if(x===-1){let M=this._hullStart;do{if(this._hullTri[M]===d){this._hullTri[M]=e;break}M=this._hullPrev[M]}while(M!==this._hullStart)}this._link(e,x),this._link(s,o[a]),this._link(a,d);const _=h+(s+1)%3;r<Ee.length&&(Ee[r++]=_)}else{if(r===0)break;e=Ee[--r]}}return a}_link(e,n){this._halfedges[e]=n,n!==-1&&(this._halfedges[n]=e)}_addTriangle(e,n,o,i,r,a){const s=this.trianglesLen;return this._triangles[s]=e,this._triangles[s+1]=n,this._triangles[s+2]=o,this._link(s,i),this._link(s+1,r),this._link(s+2,a),this.trianglesLen+=3,s}}function $n(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}function We(t,e,n,o){const i=t-n,r=e-o;return i*i+r*r}function Ie(t,e,n,o,i,r){const a=(o-e)*(i-t),s=(n-t)*(r-e);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function De(t,e,n,o,i,r){return(Ie(i,r,t,e,n,o)||Ie(t,e,n,o,i,r)||Ie(n,o,i,r,t,e))<0}function Pn(t,e,n,o,i,r,a,s){const l=t-a,h=e-s,c=n-a,d=o-s,g=i-a,m=r-s,p=l*l+h*h,f=c*c+d*d,y=g*g+m*m;return l*(d*y-f*m)-h*(c*y-f*g)+p*(c*m-d*g)<0}function Bn(t,e,n,o,i,r){const a=n-t,s=o-e,l=i-t,h=r-e,c=a*a+s*s,d=l*l+h*h,g=.5/(a*h-s*l),m=(h*c-s*d)*g,p=(a*d-l*c)*g;return m*m+p*p}function Fn(t,e,n,o,i,r){const a=n-t,s=o-e,l=i-t,h=r-e,c=a*a+s*s,d=l*l+h*h,g=.5/(a*h-s*l),m=t+(h*c-s*d)*g,p=e+(a*d-l*c)*g;return{x:m,y:p}}function we(t,e,n,o){if(o-n<=20)for(let i=n+1;i<=o;i++){const r=t[i],a=e[r];let s=i-1;for(;s>=n&&e[t[s]]>a;)t[s+1]=t[s--];t[s+1]=r}else{const i=n+o>>1;let r=n+1,a=o;Ce(t,i,r),e[t[n]]>e[t[o]]&&Ce(t,n,o),e[t[r]]>e[t[o]]&&Ce(t,r,o),e[t[n]]>e[t[r]]&&Ce(t,n,r);const s=t[r],l=e[s];for(;;){do r++;while(e[t[r]]<l);do a--;while(e[t[a]]>l);if(a<r)break;Ce(t,r,a)}t[n+1]=t[a],t[a]=s,o-r+1>=a-n?(we(t,e,r,o),we(t,e,n,a-1)):(we(t,e,n,a-1),we(t,e,r,o))}}function Ce(t,e,n){const o=t[e];t[e]=t[n],t[n]=o}function Wn(t){return t[0]}function In(t){return t[1]}const ct=1e-6;class xe{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,n){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,n){this._+=`L${this._x1=+e},${this._y1=+n}`}arc(e,n,o){e=+e,n=+n,o=+o;const i=e+o,r=n;if(o<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${r}`:(Math.abs(this._x1-i)>ct||Math.abs(this._y1-r)>ct)&&(this._+="L"+i+","+r),o&&(this._+=`A${o},${o},0,1,1,${e-o},${n}A${o},${o},0,1,1,${this._x1=i},${this._y1=r}`)}rect(e,n,o,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${+o}v${+i}h${-o}Z`}value(){return this._||null}}class He{constructor(){this._=[]}moveTo(e,n){this._.push([e,n])}closePath(){this._.push(this._[0].slice())}lineTo(e,n){this._.push([e,n])}value(){return this._.length?this._:null}}class Gn{constructor(e,[n,o,i,r]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((r=+r)>=(o=+o)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=i,this.xmin=n,this.ymax=r,this.ymin=o,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:n,triangles:o},vectors:i}=this,r=this.circumcenters=this._circumcenters.subarray(0,o.length/3*2);for(let m=0,p=0,f=o.length,y,x;m<f;m+=3,p+=2){const _=o[m]*2,M=o[m+1]*2,O=o[m+2]*2,$=e[_],D=e[_+1],Y=e[M],T=e[M+1],R=e[O],b=e[O+1],w=Y-$,k=T-D,q=R-$,E=b-D,A=w*w+k*k,I=q*q+E*E,j=(w*E-k*q)*2;if(!j)y=($+R)/2-1e8*E,x=(D+b)/2+1e8*q;else if(Math.abs(j)<1e-8)y=($+R)/2,x=(D+b)/2;else{const L=1/j;y=$+(E*A-k*I)*L,x=D+(w*I-q*A)*L}r[p]=y,r[p+1]=x}let a=n[n.length-1],s,l=a*4,h,c=e[2*a],d,g=e[2*a+1];i.fill(0);for(let m=0;m<n.length;++m)a=n[m],s=l,h=c,d=g,l=a*4,c=e[2*a],g=e[2*a+1],i[s+2]=i[l]=d-g,i[s+3]=i[l+1]=c-h}render(e){const n=e==null?e=new xe:void 0,{delaunay:{halfedges:o,inedges:i,hull:r},circumcenters:a,vectors:s}=this;if(r.length<=1)return null;for(let c=0,d=o.length;c<d;++c){const g=o[c];if(g<c)continue;const m=Math.floor(c/3)*2,p=Math.floor(g/3)*2,f=a[m],y=a[m+1],x=a[p],_=a[p+1];this._renderSegment(f,y,x,_,e)}let l,h=r[r.length-1];for(let c=0;c<r.length;++c){l=h,h=r[c];const d=Math.floor(i[h]/3)*2,g=a[d],m=a[d+1],p=l*4,f=this._project(g,m,s[p+2],s[p+3]);f&&this._renderSegment(g,m,f[0],f[1],e)}return n&&n.value()}renderBounds(e){const n=e==null?e=new xe:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(e,n){const o=n==null?n=new xe:void 0,i=this._clip(e);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let r=i.length;for(;i[0]===i[r-2]&&i[1]===i[r-1]&&r>1;)r-=2;for(let a=2;a<r;a+=2)(i[a]!==i[a-2]||i[a+1]!==i[a-1])&&n.lineTo(i[a],i[a+1]);return n.closePath(),o&&o.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let n=0,o=e.length/2;n<o;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(e){const n=new He;return this.renderCell(e,n),n.value()}_renderSegment(e,n,o,i,r){let a;const s=this._regioncode(e,n),l=this._regioncode(o,i);s===0&&l===0?(r.moveTo(e,n),r.lineTo(o,i)):(a=this._clipSegment(e,n,o,i,s,l))&&(r.moveTo(a[0],a[1]),r.lineTo(a[2],a[3]))}contains(e,n,o){return n=+n,n!==n||(o=+o,o!==o)?!1:this.delaunay._step(e,n,o)===e}*neighbors(e){const n=this._clip(e);if(n)for(const o of this.delaunay.neighbors(e)){const i=this._clip(o);if(i){e:for(let r=0,a=n.length;r<a;r+=2)for(let s=0,l=i.length;s<l;s+=2)if(n[r]==i[s]&&n[r+1]==i[s+1]&&n[(r+2)%a]==i[(s+l-2)%l]&&n[(r+3)%a]==i[(s+l-1)%l]){yield o;break e}}}}_cell(e){const{circumcenters:n,delaunay:{inedges:o,halfedges:i,triangles:r}}=this,a=o[e];if(a===-1)return null;const s=[];let l=a;do{const h=Math.floor(l/3);if(s.push(n[h*2],n[h*2+1]),l=l%3===2?l-2:l+1,r[l]!==e)break;l=i[l]}while(l!==a&&l!==-1);return s}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(e);if(n===null)return null;const{vectors:o}=this,i=e*4;return o[i]||o[i+1]?this._clipInfinite(e,n,o[i],o[i+1],o[i+2],o[i+3]):this._clipFinite(e,n)}_clipFinite(e,n){const o=n.length;let i=null,r,a,s=n[o-2],l=n[o-1],h,c=this._regioncode(s,l),d,g;for(let m=0;m<o;m+=2)if(r=s,a=l,s=n[m],l=n[m+1],h=c,c=this._regioncode(s,l),h===0&&c===0)d=g,g=0,i?i.push(s,l):i=[s,l];else{let p,f,y,x,_;if(h===0){if((p=this._clipSegment(r,a,s,l,h,c))===null)continue;[f,y,x,_]=p}else{if((p=this._clipSegment(s,l,r,a,c,h))===null)continue;[x,_,f,y]=p,d=g,g=this._edgecode(f,y),d&&g&&this._edge(e,d,g,i,i.length),i?i.push(f,y):i=[f,y]}d=g,g=this._edgecode(x,_),d&&g&&this._edge(e,d,g,i,i.length),i?i.push(x,_):i=[x,_]}if(i)d=g,g=this._edgecode(i[0],i[1]),d&&g&&this._edge(e,d,g,i,i.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(e,n,o,i,r,a){for(;;){if(r===0&&a===0)return[e,n,o,i];if(r&a)return null;let s,l,h=r||a;h&8?(s=e+(o-e)*(this.ymax-n)/(i-n),l=this.ymax):h&4?(s=e+(o-e)*(this.ymin-n)/(i-n),l=this.ymin):h&2?(l=n+(i-n)*(this.xmax-e)/(o-e),s=this.xmax):(l=n+(i-n)*(this.xmin-e)/(o-e),s=this.xmin),r?(e=s,n=l,r=this._regioncode(e,n)):(o=s,i=l,a=this._regioncode(o,i))}}_clipInfinite(e,n,o,i,r,a){let s=Array.from(n),l;if((l=this._project(s[0],s[1],o,i))&&s.unshift(l[0],l[1]),(l=this._project(s[s.length-2],s[s.length-1],r,a))&&s.push(l[0],l[1]),s=this._clipFinite(e,s))for(let h=0,c=s.length,d,g=this._edgecode(s[c-2],s[c-1]);h<c;h+=2)d=g,g=this._edgecode(s[h],s[h+1]),d&&g&&(h=this._edge(e,d,g,s,h),c=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(e,n,o,i,r){for(;n!==o;){let a,s;switch(n){case 5:n=4;continue;case 4:n=6,a=this.xmax,s=this.ymin;break;case 6:n=2;continue;case 2:n=10,a=this.xmax,s=this.ymax;break;case 10:n=8;continue;case 8:n=9,a=this.xmin,s=this.ymax;break;case 9:n=1;continue;case 1:n=5,a=this.xmin,s=this.ymin;break}(i[r]!==a||i[r+1]!==s)&&this.contains(e,a,s)&&(i.splice(r,0,a,s),r+=2)}if(i.length>4)for(let a=0;a<i.length;a+=2){const s=(a+2)%i.length,l=(a+4)%i.length;(i[a]===i[s]&&i[s]===i[l]||i[a+1]===i[s+1]&&i[s+1]===i[l+1])&&(i.splice(s,2),a-=2)}return r}_project(e,n,o,i){let r=1/0,a,s,l;if(i<0){if(n<=this.ymin)return null;(a=(this.ymin-n)/i)<r&&(l=this.ymin,s=e+(r=a)*o)}else if(i>0){if(n>=this.ymax)return null;(a=(this.ymax-n)/i)<r&&(l=this.ymax,s=e+(r=a)*o)}if(o>0){if(e>=this.xmax)return null;(a=(this.xmax-e)/o)<r&&(s=this.xmax,l=n+(r=a)*i)}else if(o<0){if(e<=this.xmin)return null;(a=(this.xmin-e)/o)<r&&(s=this.xmin,l=n+(r=a)*i)}return[s,l]}_edgecode(e,n){return(e===this.xmin?1:e===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(e,n){return(e<this.xmin?1:e>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const zn=2*Math.PI,Me=Math.pow;function Vn(t){return t[0]}function Xn(t){return t[1]}function Hn(t){const{triangles:e,coords:n}=t;for(let o=0;o<e.length;o+=3){const i=2*e[o],r=2*e[o+1],a=2*e[o+2];if((n[a]-n[i])*(n[r+1]-n[i+1])-(n[r]-n[i])*(n[a+1]-n[i+1])>1e-10)return!1}return!0}function Un(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class Je{static from(e,n=Vn,o=Xn,i){return new Je("length"in e?Zn(e,n,o,i):Float64Array.from(Kn(e,n,o,i)))}constructor(e){this._delaunator=new Pe(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,n=this.points;if(e.hull&&e.hull.length>2&&Hn(e)){this.collinear=Int32Array.from({length:n.length/2},(g,m)=>m).sort((g,m)=>n[2*g]-n[2*m]||n[2*g+1]-n[2*m+1]);const l=this.collinear[0],h=this.collinear[this.collinear.length-1],c=[n[2*l],n[2*l+1],n[2*h],n[2*h+1]],d=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let g=0,m=n.length/2;g<m;++g){const p=Un(n[2*g],n[2*g+1],d);n[2*g]=p[0],n[2*g+1]=p[1]}this._delaunator=new Pe(n)}else delete this.collinear;const o=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,r=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let l=0,h=o.length;l<h;++l){const c=r[l%3===2?l-2:l+1];(o[l]===-1||a[c]===-1)&&(a[c]=l)}for(let l=0,h=i.length;l<h;++l)s[i[l]]=l;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],a[i[0]]=1,i.length===2&&(a[i[1]]=0))}voronoi(e){return new Gn(this,e)}*neighbors(e){const{inedges:n,hull:o,_hullIndex:i,halfedges:r,triangles:a,collinear:s}=this;if(s){const d=s.indexOf(e);d>0&&(yield s[d-1]),d<s.length-1&&(yield s[d+1]);return}const l=n[e];if(l===-1)return;let h=l,c=-1;do{if(yield c=a[h],h=h%3===2?h-2:h+1,a[h]!==e)return;if(h=r[h],h===-1){const d=o[(i[e]+1)%o.length];d!==c&&(yield d);return}}while(h!==l)}find(e,n,o=0){if(e=+e,e!==e||(n=+n,n!==n))return-1;const i=o;let r;for(;(r=this._step(o,e,n))>=0&&r!==o&&r!==i;)o=r;return r}_step(e,n,o){const{inedges:i,hull:r,_hullIndex:a,halfedges:s,triangles:l,points:h}=this;if(i[e]===-1||!h.length)return(e+1)%(h.length>>1);let c=e,d=Me(n-h[e*2],2)+Me(o-h[e*2+1],2);const g=i[e];let m=g;do{let p=l[m];const f=Me(n-h[p*2],2)+Me(o-h[p*2+1],2);if(f<d&&(d=f,c=p),m=m%3===2?m-2:m+1,l[m]!==e)break;if(m=s[m],m===-1){if(m=r[(a[e]+1)%r.length],m!==p&&Me(n-h[m*2],2)+Me(o-h[m*2+1],2)<d)return m;break}}while(m!==g);return c}render(e){const n=e==null?e=new xe:void 0,{points:o,halfedges:i,triangles:r}=this;for(let a=0,s=i.length;a<s;++a){const l=i[a];if(l<a)continue;const h=r[a]*2,c=r[l]*2;e.moveTo(o[h],o[h+1]),e.lineTo(o[c],o[c+1])}return this.renderHull(e),n&&n.value()}renderPoints(e,n=2){const o=e==null?e=new xe:void 0,{points:i}=this;for(let r=0,a=i.length;r<a;r+=2){const s=i[r],l=i[r+1];e.moveTo(s+n,l),e.arc(s,l,n,0,zn)}return o&&o.value()}renderHull(e){const n=e==null?e=new xe:void 0,{hull:o,points:i}=this,r=o[0]*2,a=o.length;e.moveTo(i[r],i[r+1]);for(let s=1;s<a;++s){const l=2*o[s];e.lineTo(i[l],i[l+1])}return e.closePath(),n&&n.value()}hullPolygon(){const e=new He;return this.renderHull(e),e.value()}renderTriangle(e,n){const o=n==null?n=new xe:void 0,{points:i,triangles:r}=this,a=r[e*=3]*2,s=r[e+1]*2,l=r[e+2]*2;return n.moveTo(i[a],i[a+1]),n.lineTo(i[s],i[s+1]),n.lineTo(i[l],i[l+1]),n.closePath(),o&&o.value()}*trianglePolygons(){const{triangles:e}=this;for(let n=0,o=e.length/3;n<o;++n)yield this.trianglePolygon(n)}trianglePolygon(e){const n=new He;return this.renderTriangle(e,n),n.value()}}function Zn(t,e,n,o){const i=t.length,r=new Float64Array(i*2);for(let a=0;a<i;++a){const s=t[a];r[a*2]=e.call(o,s,a,t),r[a*2+1]=n.call(o,s,a,t)}return r}function*Kn(t,e,n,o){let i=0;for(const r of t)yield e.call(o,r,i,t),yield n.call(o,r,i,t),++i}var ht=function(t){return typeof t=="function"?t:function(e){return e[t]}},Nn=function(t){var e=t.points,n=t.x,o=n===void 0?"x":n,i=t.y,r=i===void 0?"y":i,a=ht(o),s=ht(r);return e.map(function(l){return[a(l),s(l)]})},Qn=function(t){var e=t.points,n=t.width,o=t.height,i=t.debug,r=Je.from(e),a=i?r.voronoi([0,0,n,o]):void 0;return{delaunay:r,voronoi:a}},Tt=function(t){var e=t.points,n=t.x,o=t.y,i=t.width,r=t.height,a=t.debug,s=S.useMemo(function(){return Nn({points:e,x:n,y:o})},[e,n,o]);return S.useMemo(function(){return Qn({points:s,width:i,height:r,debug:a})},[s,i,r,a])},Jn=function(t){var e=t.nodes,n=t.width,o=t.height,i=t.x,r=t.y,a=t.onMouseEnter,s=t.onMouseMove,l=t.onMouseLeave,h=t.onClick,c=t.debug,d=S.useRef(null),g=S.useState(null),m=g[0],p=g[1],f=Tt({points:e,x:i,y:r,width:n,height:o,debug:c}),y=f.delaunay,x=f.voronoi,_=S.useMemo(function(){if(c&&x)return x.render()},[c,x]),M=S.useCallback(function(T){if(!d.current)return[null,null];var R=pt(d.current,T),b=R[0],w=R[1],k=y.find(b,w);return[k,k!==void 0?e[k]:null]},[d,y]),O=S.useCallback(function(T){var R=M(T),b=R[0],w=R[1];p(b),w&&(a==null||a(w,T))},[M,p,a]),$=S.useCallback(function(T){var R=M(T),b=R[0],w=R[1];p(b),w&&(s==null||s(w,T))},[M,p,s]),D=S.useCallback(function(T){if(p(null),l){var R=void 0;m!==null&&(R=e[m]),R&&l(R,T)}},[p,m,l,e]),Y=S.useCallback(function(T){var R=M(T),b=R[0],w=R[1];p(b),w&&(h==null||h(w,T))},[M,p,h]);return v.jsxs("g",{ref:d,children:[c&&x&&v.jsxs(v.Fragment,{children:[v.jsx("path",{d:_,stroke:"red",strokeWidth:1,opacity:.75}),m!==null&&v.jsx("path",{fill:"pink",opacity:.35,d:x.renderCell(m)})]}),v.jsx("rect",{width:n,height:o,fill:"red",opacity:0,style:{cursor:"auto"},onMouseEnter:O,onMouseMove:$,onMouseLeave:D,onClick:Y})]})},ei=function(t,e){t.save(),t.globalAlpha=.75,t.beginPath(),e.render(t),t.strokeStyle="red",t.lineWidth=1,t.stroke(),t.restore()},ti=function(t,e,n){t.save(),t.globalAlpha=.35,t.beginPath(),e.renderCell(n,t),t.fillStyle="red",t.fill(),t.restore()};function Q(){return Q=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Q.apply(this,arguments)}var Ct=function(t){var e=t.point;return v.jsx(rn,{id:v.jsxs("span",{children:["x: ",v.jsx("strong",{children:e.data.xFormatted}),", y:"," ",v.jsx("strong",{children:e.data.yFormatted})]}),enableChip:!0,color:e.serieColor})};Ct.propTypes={point:u.object.isRequired};var ni=S.memo(Ct),jt=function(t){var e=t.slice,n=t.axis,o=je(),i=n==="x"?"y":"x";return v.jsx(sn,{rows:e.points.map(function(r){return[v.jsx(on,{color:r.serieColor,style:o.tooltip.chip},"chip"),r.serieId,v.jsx("span",{style:o.tooltip.tableCellValue,children:r.data[i+"Formatted"]},"value")]})})};jt.propTypes={slice:u.object.isRequired,axis:u.oneOf(["x","y"]).isRequired};var ii=S.memo(jt),Rt={data:u.arrayOf(u.shape({id:u.oneOfType([u.string,u.number]).isRequired,data:u.arrayOf(u.shape({x:u.oneOfType([u.number,u.string,u.instanceOf(Date)]),y:u.oneOfType([u.number,u.string,u.instanceOf(Date)])})).isRequired})).isRequired,xScale:u.object.isRequired,xFormat:u.oneOfType([u.func,u.string]),yScale:u.object.isRequired,yFormat:u.oneOfType([u.func,u.string]),layers:u.arrayOf(u.oneOfType([u.oneOf(["grid","markers","axes","areas","crosshair","lines","slices","points","mesh","legends"]),u.func])).isRequired,curve:en.isRequired,axisTop:Ye,axisRight:Ye,axisBottom:Ye,axisLeft:Ye,enableGridX:u.bool.isRequired,enableGridY:u.bool.isRequired,gridXValues:u.oneOfType([u.number,u.arrayOf(u.oneOfType([u.number,u.string,u.instanceOf(Date)]))]),gridYValues:u.oneOfType([u.number,u.arrayOf(u.oneOfType([u.number,u.string,u.instanceOf(Date)]))]),enablePoints:u.bool.isRequired,pointSymbol:u.func,pointSize:u.number.isRequired,pointColor:u.any.isRequired,pointBorderWidth:u.number.isRequired,pointBorderColor:u.any.isRequired,enablePointLabel:u.bool.isRequired,pointLabel:u.oneOfType([u.string,u.func]).isRequired,markers:u.arrayOf(u.shape({axis:u.oneOf(["x","y"]).isRequired,value:u.oneOfType([u.number,u.string,u.instanceOf(Date)]).isRequired,style:u.object})),colors:tn.isRequired,enableArea:u.bool.isRequired,areaOpacity:u.number.isRequired,areaBlendMode:Ke.isRequired,areaBaselineValue:u.oneOfType([u.number,u.string,u.instanceOf(Date)]).isRequired,lineWidth:u.number.isRequired,legends:u.arrayOf(u.shape(nn)).isRequired,isInteractive:u.bool.isRequired,debugMesh:u.bool.isRequired,tooltip:u.oneOfType([u.func,u.object]).isRequired,enableSlices:u.oneOf(["x","y",!1]).isRequired,debugSlices:u.bool.isRequired,sliceTooltip:u.oneOfType([u.func,u.object]).isRequired,enableCrosshair:u.bool.isRequired,crosshairType:u.string.isRequired},ri=Q({},Rt,{enablePointLabel:u.bool.isRequired,role:u.string.isRequired,useMesh:u.bool.isRequired},an,ln),si=Q({pixelRatio:u.number.isRequired},Rt),Ot={curve:"linear",xScale:{type:"point"},yScale:{type:"linear",min:0,max:"auto"},layers:["grid","markers","axes","areas","crosshair","lines","points","slices","mesh","legends"],axisBottom:{},axisLeft:{},enableGridX:!0,enableGridY:!0,enablePoints:!0,pointSize:6,pointColor:{from:"color"},pointBorderWidth:0,pointBorderColor:{theme:"background"},enablePointLabel:!1,pointLabel:"yFormatted",colors:{scheme:"nivo"},enableArea:!1,areaBaselineValue:0,areaOpacity:.2,areaBlendMode:"normal",lineWidth:2,legends:[],isInteractive:!0,tooltip:ni,enableSlices:!1,debugSlices:!1,sliceTooltip:ii,debugMesh:!1,enableCrosshair:!0,crosshairType:"bottom-left"},ce=Q({},Ot,{enablePointLabel:!1,useMesh:!1,animate:!0,motionConfig:"gentle",defs:[],fill:[],role:"img"}),oi=Q({},Ot,{pixelRatio:typeof window<"u"&&window.devicePixelRatio||1}),ai=function(t){var e=t.curve;return S.useMemo(function(){return kt().defined(function(n){return n.x!==null&&n.y!==null}).x(function(n){return n.x}).y(function(n){return n.y}).curve(Mt(e))},[e])},li=function(t){var e=t.curve,n=t.yScale,o=t.areaBaselineValue;return S.useMemo(function(){return An().defined(function(i){return i.x!==null&&i.y!==null}).x(function(i){return i.x}).y1(function(i){return i.y}).curve(Mt(e)).y0(n(o))},[e,n,o])},ui=function(t){var e=t.enableSlices,n=t.points,o=t.width,i=t.height;return S.useMemo(function(){if(e===!1)return[];if(e==="x"){var r=new Map;return n.forEach(function(s){s.data.x!==null&&s.data.y!==null&&(r.has(s.x)?r.get(s.x).push(s):r.set(s.x,[s]))}),Array.from(r.entries()).sort(function(s,l){return s[0]-l[0]}).map(function(s,l,h){var c,d=s[0],g=s[1],m=h[l-1],p=h[l+1];return{id:d,x0:c=m?d-(d-m[0])/2:d,x:d,y0:0,y:0,width:p?d-c+(p[0]-d)/2:o-c,height:i,points:g.reverse()}})}if(e==="y"){var a=new Map;return n.forEach(function(s){s.data.x!==null&&s.data.y!==null&&(a.has(s.y)?a.get(s.y).push(s):a.set(s.y,[s]))}),Array.from(a.entries()).sort(function(s,l){return s[0]-l[0]}).map(function(s,l,h){var c,d,g=s[0],m=s[1],p=h[l-1],f=h[l+1];return c=p?g-(g-p[0])/2:g,d=f?g-c+(f[0]-g)/2:i-c,{id:g,x0:0,x:0,y0:c,y:g,width:o,height:d,points:m.reverse()}})}},[e,n])},qt=function(t){var e=t.data,n=t.xScale,o=n===void 0?ce.xScale:n,i=t.xFormat,r=t.yScale,a=r===void 0?ce.yScale:r,s=t.yFormat,l=t.width,h=t.height,c=t.colors,d=c===void 0?ce.colors:c,g=t.curve,m=g===void 0?ce.curve:g,p=t.areaBaselineValue,f=p===void 0?ce.areaBaselineValue:p,y=t.pointColor,x=y===void 0?ce.pointColor:y,_=t.pointBorderColor,M=_===void 0?ce.pointBorderColor:_,O=t.enableSlices,$=O===void 0?ce.enableSlicesTooltip:O,D=at(i),Y=at(s),T=Mn(d,"id"),R=je(),b=$e(x,R),w=$e(M,R),k=S.useState([]),q=k[0],E=k[1],A=S.useMemo(function(){return wn(e.filter(function(P){return q.indexOf(P.id)===-1}),o,a,l,h)},[e,q,o,a,l,h]),I=A.xScale,j=A.yScale,L=A.series,B=S.useMemo(function(){var P=e.map(function(F){return{id:F.id,label:F.id,color:T(F)}}),H=P.map(function(F){return Q({},L.find(function(X){return X.id===F.id}),{color:F.color})}).filter(function(F){return Boolean(F.id)});return{legendData:P.map(function(F){return Q({},F,{hidden:!H.find(function(X){return X.id===F.id})})}).reverse(),series:H}},[e,L,T]),G=B.legendData,z=B.series,J=S.useCallback(function(P){E(function(H){return H.indexOf(P)>-1?H.filter(function(F){return F!==P}):[].concat(H,[P])})},[]),ie=function(P){var H=P.series,F=P.getPointColor,X=P.getPointBorderColor,le=P.formatX,U=P.formatY;return S.useMemo(function(){return H.reduce(function(te,K){return[].concat(te,K.data.filter(function(Z){return Z.position.x!==null&&Z.position.y!==null}).map(function(Z,ae){var N={id:K.id+"."+ae,index:te.length+ae,serieId:K.id,serieColor:K.color,x:Z.position.x,y:Z.position.y};return N.color=F(K),N.borderColor=X(N),N.data=Q({},Z.data,{xFormatted:le(Z.data.x),yFormatted:U(Z.data.y)}),N}))},[])},[H,F,X,le,U])}({series:z,getPointColor:b,getPointBorderColor:w,formatX:D,formatY:Y}),ee=ui({enableSlices:$,points:ie,width:l,height:h});return{legendData:G,toggleSerie:J,lineGenerator:ai({curve:m}),areaGenerator:li({curve:m,yScale:j,areaBaselineValue:f}),getColor:T,series:z,xScale:I,yScale:j,slices:ee,points:ie}},Lt=function(t){var e=t.areaBlendMode,n=t.areaOpacity,o=t.color,i=t.fill,r=t.path,a=hn(),s=a.animate,l=a.config,h=xt(r),c=dn({color:o,config:l,immediate:!s});return v.jsx(vt.path,{d:h,fill:i||c.color,fillOpacity:n,strokeWidth:0,style:{mixBlendMode:e}})};Lt.propTypes={areaBlendMode:Ke.isRequired,areaOpacity:u.number.isRequired,color:u.string,fill:u.string,path:u.string.isRequired};var Yt=function(t){var e=t.areaGenerator,n=t.areaOpacity,o=t.areaBlendMode,i=t.lines.slice(0).reverse();return v.jsx("g",{children:i.map(function(r){return v.jsx(Lt,Q({path:e(r.data.map(function(a){return a.position}))},Q({areaOpacity:n,areaBlendMode:o},r)),r.id)})})};Yt.propTypes={areaGenerator:u.func.isRequired,areaOpacity:u.number.isRequired,areaBlendMode:Ke.isRequired,lines:u.arrayOf(u.object).isRequired};var ci=S.memo(Yt),Et=function(t){var e=t.lineGenerator,n=t.points,o=t.color,i=t.thickness,r=S.useMemo(function(){return e(n)},[e,n]),a=xt(r);return v.jsx(vt.path,{d:a,fill:"none",strokeWidth:i,stroke:o})};Et.propTypes={points:u.arrayOf(u.shape({x:u.oneOfType([u.string,u.number]),y:u.oneOfType([u.string,u.number])})),lineGenerator:u.func.isRequired,color:u.string.isRequired,thickness:u.number.isRequired};var hi=S.memo(Et),Dt=function(t){var e=t.lines,n=t.lineGenerator,o=t.lineWidth;return e.slice(0).reverse().map(function(i){var r=i.id,a=i.data,s=i.color;return v.jsx(hi,{id:r,points:a.map(function(l){return l.position}),lineGenerator:n,color:s,thickness:o},r)})};Dt.propTypes={lines:u.arrayOf(u.shape({id:u.oneOfType([u.string,u.number]).isRequired,color:u.string.isRequired,data:u.arrayOf(u.shape({data:u.shape({x:u.oneOfType([u.string,u.number,u.instanceOf(Date)]),y:u.oneOfType([u.string,u.number,u.instanceOf(Date)])}).isRequired,position:u.shape({x:u.number,y:u.number}).isRequired})).isRequired})).isRequired,lineWidth:u.number.isRequired,lineGenerator:u.func.isRequired};var di=S.memo(Dt),At=function(t){var e=t.slice,n=t.axis,o=t.debug,i=t.tooltip,r=t.isCurrent,a=t.setCurrent,s=Ne(),l=s.showTooltipFromEvent,h=s.hideTooltip,c=S.useCallback(function(m){l(S.createElement(i,{slice:e,axis:n}),m,"right"),a(e)},[l,i,e]),d=S.useCallback(function(m){l(S.createElement(i,{slice:e,axis:n}),m,"right")},[l,i,e]),g=S.useCallback(function(){h(),a(null)},[h]);return v.jsx("rect",{x:e.x0,y:e.y0,width:e.width,height:e.height,stroke:"red",strokeWidth:o?1:0,strokeOpacity:.75,fill:"red",fillOpacity:r&&o?.35:0,onMouseEnter:c,onMouseMove:d,onMouseLeave:g})};At.propTypes={slice:u.object.isRequired,axis:u.oneOf(["x","y"]).isRequired,debug:u.bool.isRequired,height:u.number.isRequired,tooltip:u.oneOfType([u.func,u.object]),isCurrent:u.bool.isRequired,setCurrent:u.func.isRequired};var fi=S.memo(At),$t=function(t){var e=t.slices,n=t.axis,o=t.debug,i=t.height,r=t.tooltip,a=t.current,s=t.setCurrent;return e.map(function(l){return v.jsx(fi,{slice:l,axis:n,debug:o,height:i,tooltip:r,setCurrent:s,isCurrent:a!==null&&a.id===l.id},l.id)})};$t.propTypes={slices:u.arrayOf(u.shape({id:u.oneOfType([u.number,u.string,u.instanceOf(Date)]).isRequired,x:u.number.isRequired,y:u.number.isRequired,points:u.arrayOf(u.object).isRequired})).isRequired,axis:u.oneOf(["x","y"]).isRequired,debug:u.bool.isRequired,height:u.number.isRequired,tooltip:u.oneOfType([u.func,u.object]).isRequired,current:u.object,setCurrent:u.func.isRequired};var mi=S.memo($t),Pt=function(t){var e=t.points,n=t.symbol,o=t.size,i=t.borderWidth,r=t.enableLabel,a=t.label,s=t.labelYOffset,l=je(),h=un(a),c=e.slice(0).reverse().map(function(d){return{id:d.id,x:d.x,y:d.y,datum:d.data,fill:d.color,stroke:d.borderColor,label:r?h(d.data):null}});return v.jsx("g",{children:c.map(function(d){return v.jsx(cn,{x:d.x,y:d.y,datum:d.datum,symbol:n,size:o,color:d.fill,borderWidth:i,borderColor:d.stroke,label:d.label,labelYOffset:s,theme:l},d.id)})})};Pt.propTypes={points:u.arrayOf(u.object),symbol:u.func,size:u.number.isRequired,color:u.func.isRequired,borderWidth:u.number.isRequired,borderColor:u.func.isRequired,enableLabel:u.bool.isRequired,label:u.oneOfType([u.string,u.func]).isRequired,labelYOffset:u.number};var gi=S.memo(Pt),Bt=function(t){var e=t.points,n=t.width,o=t.height,i=t.margin,r=t.setCurrent,a=t.onMouseEnter,s=t.onMouseMove,l=t.onMouseLeave,h=t.onClick,c=t.tooltip,d=t.debug,g=Ne(),m=g.showTooltipAt,p=g.hideTooltip,f=S.useCallback(function(M,O){m(S.createElement(c,{point:M}),[M.x+i.left,M.y+i.top],"top"),r(M),a&&a(M,O)},[r,m,c,a,i]),y=S.useCallback(function(M,O){m(S.createElement(c,{point:M}),[M.x+i.left,M.y+i.top],"top"),r(M),s&&s(M,O)},[r,m,c,s]),x=S.useCallback(function(M,O){p(),r(null),l&&l(M,O)},[p,r,l]),_=S.useCallback(function(M,O){h&&h(M,O)},[h]);return v.jsx(Jn,{nodes:e,width:n,height:o,onMouseEnter:f,onMouseMove:y,onMouseLeave:x,onClick:_,debug:d})};Bt.propTypes={points:u.arrayOf(u.object).isRequired,width:u.number.isRequired,height:u.number.isRequired,margin:u.object.isRequired,setCurrent:u.func.isRequired,onMouseEnter:u.func,onMouseMove:u.func,onMouseLeave:u.func,onClick:u.func,tooltip:u.oneOfType([u.func,u.object]).isRequired,debug:u.bool.isRequired};var pi=S.memo(Bt),Ue=function(t){var e=t.data,n=t.xScale,o=t.xFormat,i=t.yScale,r=t.yFormat,a=t.layers,s=t.curve,l=t.areaBaselineValue,h=t.colors,c=t.margin,d=t.width,g=t.height,m=t.axisTop,p=t.axisRight,f=t.axisBottom,y=t.axisLeft,x=t.enableGridX,_=t.enableGridY,M=t.gridXValues,O=t.gridYValues,$=t.lineWidth,D=t.enableArea,Y=t.areaOpacity,T=t.areaBlendMode,R=t.enablePoints,b=t.pointSymbol,w=t.pointSize,k=t.pointColor,q=t.pointBorderWidth,E=t.pointBorderColor,A=t.enablePointLabel,I=t.pointLabel,j=t.pointLabelYOffset,L=t.defs,B=t.fill,G=t.markers,z=t.legends,J=t.isInteractive,ie=t.useMesh,ee=t.debugMesh,P=t.onMouseEnter,H=t.onMouseMove,F=t.onMouseLeave,X=t.onClick,le=t.tooltip,U=t.enableSlices,te=t.debugSlices,K=t.sliceTooltip,Z=t.enableCrosshair,ae=t.crosshairType,N=t.role,ue=_t(d,g,c),de=ue.margin,ne=ue.innerWidth,se=ue.innerHeight,Re=ue.outerWidth,Oe=ue.outerHeight,re=qt({data:e,xScale:n,xFormat:o,yScale:i,yFormat:r,width:ne,height:se,colors:h,curve:s,areaBaselineValue:l,pointColor:k,pointBorderColor:E,enableSlices:U}),qe=re.legendData,Le=re.toggleSerie,fe=re.lineGenerator,Se=re.areaGenerator,ve=re.series,_e=re.xScale,C=re.yScale,V=re.slices,he=re.points,W=je(),me=$e(k,W),Ft=$e(E,W),et=S.useState(null),ke=et[0],tt=et[1],nt=S.useState(null),Te=nt[0],it=nt[1],ge={grid:v.jsx(fn,{theme:W,width:ne,height:se,xScale:x?_e:null,yScale:_?C:null,xValues:M,yValues:O},"grid"),markers:v.jsx(mn,{markers:G,width:ne,height:se,xScale:_e,yScale:C,theme:W},"markers"),axes:v.jsx(gn,{xScale:_e,yScale:C,width:ne,height:se,theme:W,top:m,right:p,bottom:f,left:y},"axes"),areas:null,lines:v.jsx(di,{lines:ve,lineGenerator:fe,lineWidth:$},"lines"),slices:null,points:null,crosshair:null,mesh:null,legends:z.map(function(pe,Be){return v.jsx(pn,Q({},pe,{containerWidth:ne,containerHeight:se,data:pe.data||qe,theme:W,toggleSerie:pe.toggleSerie?Le:void 0}),"legend."+Be)})},Wt=yn(L,ve,B);return D&&(ge.areas=v.jsx(ci,{areaGenerator:Se,areaOpacity:Y,areaBlendMode:T,lines:ve},"areas")),J&&U!==!1&&(ge.slices=v.jsx(mi,{slices:V,axis:U,debug:te,height:se,tooltip:K,current:Te,setCurrent:it},"slices")),R&&(ge.points=v.jsx(gi,{points:he,symbol:b,size:w,color:me,borderWidth:q,borderColor:Ft,enableLabel:A,label:I,labelYOffset:j},"points")),J&&Z&&(ke!==null&&(ge.crosshair=v.jsx(st,{width:ne,height:se,x:ke.x,y:ke.y,type:ae},"crosshair")),Te!==null&&(ge.crosshair=v.jsx(st,{width:ne,height:se,x:Te.x,y:Te.y,type:U},"crosshair"))),J&&ie&&U===!1&&(ge.mesh=v.jsx(pi,{points:he,width:ne,height:se,margin:de,current:ke,setCurrent:tt,onMouseEnter:P,onMouseMove:H,onMouseLeave:F,onClick:X,tooltip:le,debug:ee},"mesh")),v.jsx(bn,{defs:Wt,width:Re,height:Oe,margin:de,role:N,children:a.map(function(pe,Be){return typeof pe=="function"?v.jsx(S.Fragment,{children:pe(Q({},t,{innerWidth:ne,innerHeight:se,series:ve,slices:V,points:he,xScale:_e,yScale:C,lineGenerator:fe,areaGenerator:Se,currentPoint:ke,setCurrentPoint:tt,currentSlice:Te,setCurrentSlice:it}))},Be):ge[pe]})})};Ue.propTypes=ri,Ue.defaultProps=ce;var yi=yt(Ue),bi=function(t){return v.jsx(bt,{children:function(e){var n=e.width,o=e.height;return v.jsx(yi,Q({width:n,height:o},t))}})},Ze=function(t){var e=t.width,n=t.height,o=t.margin,i=t.pixelRatio,r=t.data,a=t.xScale,s=t.xFormat,l=t.yScale,h=t.yFormat,c=t.curve,d=t.layers,g=t.colors,m=t.lineWidth,p=t.enableArea,f=t.areaBaselineValue,y=t.areaOpacity,x=t.enablePoints,_=t.pointSize,M=t.pointColor,O=t.pointBorderWidth,$=t.pointBorderColor,D=t.enableGridX,Y=t.gridXValues,T=t.enableGridY,R=t.gridYValues,b=t.axisTop,w=t.axisRight,k=t.axisBottom,q=t.axisLeft,E=t.legends,A=t.isInteractive,I=t.debugMesh,j=t.onMouseLeave,L=t.onClick,B=t.tooltip,G=t.canvasRef,z=S.useRef(null),J=_t(e,n,o),ie=J.margin,ee=J.innerWidth,P=J.innerHeight,H=J.outerWidth,F=J.outerHeight,X=je(),le=S.useState(null),U=le[0],te=le[1],K=qt({data:r,xScale:a,xFormat:s,yScale:l,yFormat:h,width:ee,height:P,colors:g,curve:c,areaBaselineValue:f,pointColor:M,pointBorderColor:$}),Z=K.lineGenerator,ae=K.areaGenerator,N=K.series,ue=K.xScale,de=K.yScale,ne=K.points,se=Tt({points:ne,width:ee,height:P,debug:I}),Re=se.delaunay,Oe=se.voronoi;S.useEffect(function(){G&&(G.current=z.current),z.current.width=H*i,z.current.height=F*i;var C=z.current.getContext("2d");C.scale(i,i),C.fillStyle=X.background,C.fillRect(0,0,H,F),C.translate(ie.left,ie.top),d.forEach(function(V){if(typeof V=="function"&&V({ctx:C,innerWidth:ee,innerHeight:P,series:N,points:ne,xScale:ue,yScale:de,lineWidth:m,lineGenerator:Z,areaGenerator:ae,currentPoint:U,setCurrentPoint:te}),V==="grid"&&X.grid.line.strokeWidth>0&&(C.lineWidth=X.grid.line.strokeWidth,C.strokeStyle=X.grid.line.stroke,D&&ot(C,{width:ee,height:P,scale:ue,axis:"x",values:Y}),T&&ot(C,{width:ee,height:P,scale:de,axis:"y",values:R})),V==="axes"&&xn(C,{xScale:ue,yScale:de,width:ee,height:P,top:b,right:w,bottom:k,left:q,theme:X}),V==="areas"&&p===!0&&(C.save(),C.globalAlpha=y,ae.context(C),N.forEach(function(W){C.fillStyle=W.color,C.beginPath(),ae(W.data.map(function(me){return me.position})),C.fill()}),C.restore()),V==="lines"&&(Z.context(C),N.forEach(function(W){C.strokeStyle=W.color,C.lineWidth=m,C.beginPath(),Z(W.data.map(function(me){return me.position})),C.stroke()})),V==="points"&&x===!0&&_>0&&ne.forEach(function(W){C.fillStyle=W.color,C.beginPath(),C.arc(W.x,W.y,_/2,0,2*Math.PI),C.fill(),O>0&&(C.strokeStyle=W.borderColor,C.lineWidth=O,C.stroke())}),V==="mesh"&&I===!0&&(ei(C,Oe),U&&ti(C,Oe,U.index)),V==="legends"){var he=N.map(function(W){return{id:W.id,label:W.id,color:W.color}}).reverse();E.forEach(function(W){vn(C,Q({},W,{data:W.data||he,containerWidth:ee,containerHeight:P,theme:X}))})}})},[z,H,F,d,X,Z,N,ue,de,D,Y,T,R,b,w,k,q,E,ne,x,_,U]);var re=S.useCallback(function(C){var V=pt(z.current,C),he=V[0],W=V[1];if(!_n(ie.left,ie.top,ee,P,he,W))return null;var me=Re.find(he-ie.left,W-ie.top);return ne[me]},[z,ie,ee,P,Re]),qe=Ne(),Le=qe.showTooltipFromEvent,fe=qe.hideTooltip,Se=S.useCallback(function(C){var V=re(C);te(V),V?Le(S.createElement(B,{point:V}),C):fe()},[re,te,Le,fe,B]),ve=S.useCallback(function(C){fe(),te(null),U&&j&&j(U,C)},[fe,te,j]),_e=S.useCallback(function(C){if(L){var V=re(C);V&&L(V,C)}},[re,L]);return v.jsx("canvas",{ref:z,width:H*i,height:F*i,style:{width:H,height:F,cursor:A?"auto":"normal"},onMouseEnter:A?Se:void 0,onMouseMove:A?Se:void 0,onMouseLeave:A?ve:void 0,onClick:A?_e:void 0})};Ze.propTypes=si,Ze.defaultProps=oi;var xi=yt(Ze),vi=S.forwardRef(function(t,e){return v.jsx(xi,Q({},t,{canvasRef:e}))});S.forwardRef(function(t,e){return v.jsx(bt,{children:function(n){var o=n.width,i=n.height;return v.jsx(vi,Q({width:o,height:i},t,{ref:e}))}})});be.extend(En);function _i({data:t,timeUnit:e,height:n=260,enableLeftTicks:o,enableBottomTicks:i}){const r=Xt();return v.jsx(dt,{pt:"md",sx:{height:n,width:"100%"},children:!!t[0].data.length&&v.jsx(bi,{data:t,margin:{top:6,right:12,bottom:i?28:6,left:o?56:12},xScale:{type:"time",format:e==="day"?"%Y-%m-%d":"%b",useUTC:!1,precision:e},xFormat:`time:${e==="day"?"%Y-%m-%d":"%b"}`,yScale:{type:"linear"},axisLeft:{tickPadding:10,tickValues:2},axisBottom:{format:e==="day"?"%e":"%b",tickPadding:10,tickValues:`every ${e}`},curve:"monotoneX",defs:[Sn("gradient",[{offset:0,color:"inherit"},{offset:100,color:"inherit",opacity:0}])],areaOpacity:r.colorScheme==="dark"?.25:.5,fill:[{match:"*",id:"gradient"}],theme:{textColor:r.colorScheme==="dark"?r.colors.dark[2]:r.colors.gray[6],fontSize:12,axis:{ticks:{line:{strokeWidth:0}}},crosshair:{line:{stroke:r.colorScheme==="dark"?r.colors.dark[1]:r.colors.gray[7]}}},sliceTooltip:({slice:a})=>v.jsx(Ht,{p:"sm",bg:r.colorScheme==="dark"?r.colors.dark[8]:r.colors.gray[1],shadow:r.shadows.md,children:a.points.map(s=>v.jsxs(mt,{spacing:"sm",children:[v.jsx(Ut,{size:14,color:s.serieColor}),v.jsx(rt,{size:"sm",color:"dimmed",inline:!0,children:e==="day"?be(s.data.xFormatted).format("dddd, D MMM"):be(s.data.xFormatted,"MMM").format("MMMM YYYY")}),v.jsxs(rt,{size:"sm",weight:"bold",inline:!0,children:["$",s.data.yFormatted]})]},s.id))}),colors:[r.colors[r.primaryColor][5]],enableGridX:!1,enableGridY:!1,pointSize:8,pointBorderWidth:2,pointLabelYOffset:-12,enableArea:!0,enableSlices:"x",useMesh:!0,motionConfig:"default"})})}function Ri({visibleNumbers:t}){const[e,n]=Zt({key:"earnings-filters",defaultValue:{timeframe:"week",excludedDays:["0"],enableLeftTicks:!1,enableBottomTicks:!0},getInitialValueInEffect:!1}),o=f=>{n(y=>({...y,...f}))},[i,r]=S.useState([null,null]),[a,s]=e.timeframe==="custom"?i.map(f=>be(f)):[be().startOf(e.timeframe),be()],l=[Fe("status","==","delivered"),Fe("deliveredTimestamp",">=",a.valueOf())];e.timeframe==="custom"&&l.push(Fe("deliveredTimestamp","<=",s.endOf("day").valueOf()));const h=Kt(Nt,...l),[c]=Qt(h),{data:d,timeUnit:g,totalEarnings:m,orderCount:p}=S.useMemo(()=>{const{timeframe:f}=e,y=e.excludedDays.map($=>+$),x=[];let _="day",M=0,O=0;if(c){const $={},D=f==="year"?"MMM":"YYYY-MM-DD";_=f==="year"?"month":"day";for(let Y=0;Y<=s.diff(a,_);Y++){const T=a.add(Y,_),R=T.format(D);(f==="year"||!y.includes(T.day()))&&($[R]=0)}c.forEach(Y=>{const T=be(Y.deliveredTimestamp),R=T.format(D);y.includes(T.day())||($[R]+=Y.price,O++)}),Object.entries($).forEach(([Y,T])=>{x.push({x:Y,y:T}),M+=T})}return{data:x,timeUnit:_,totalEarnings:M,orderCount:O}},[e.excludedDays,c]);return v.jsxs(Ae,{children:[v.jsx(Jt,{in:!!c,style:{minHeight:336},children:v.jsxs(Ae,{spacing:0,children:[v.jsx(kn,{items:[{text:t?`$${m.toLocaleString()}`:"*****",sub:"Total"},{text:p,sub:"Orders"}]}),v.jsx(ft,{in:t&&d.length>1,children:v.jsx(_i,{data:[{id:"Earnings",data:d}],timeUnit:g,enableLeftTicks:e.enableLeftTicks,enableBottomTicks:e.enableBottomTicks})})]})}),v.jsx(Ln,{filters:e,updateFilter:o,dateRange:i,setDateRange:r})]})}export{Ri as default};
