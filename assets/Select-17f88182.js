import{N as at,ao as lt,r as w,ap as ce,aq as ue,K as g,S as ot}from"./index-5e2edfad.js";import{D as rt,u as st,g as it,a as G,b as ct,c as ut,d as dt}from"./LabeledSegmentedControl-41c67f9f.js";import{g as ft}from"./index-a5831603.js";import{I as de}from"./useCollectionDataPersistent-d403fc62.js";function pt({data:t,searchable:a,limit:l,searchValue:o,filter:_,value:M,filterDataOnExactSearchMatch:j}){if(!a)return t;const y=M!=null&&t.find(d=>d.value===M)||null;if(y&&!j&&(y==null?void 0:y.label)===o){if(l){if(l>=t.length)return t;const d=t.indexOf(y),R=d+l,E=R-t.length;return E>0?t.slice(d-E):t.slice(d,R)}return t}const P=[];for(let d=0;d<t.length&&(_(o,t[d])&&P.push(t[d]),!(P.length>=l));d+=1);return P}var ht=at(()=>({input:{"&:not(:disabled)":{cursor:"pointer","&::selection":{backgroundColor:"transparent"}}}}));const mt=ht;var bt=Object.defineProperty,vt=Object.defineProperties,wt=Object.getOwnPropertyDescriptors,H=Object.getOwnPropertySymbols,pe=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,fe=(t,a,l)=>a in t?bt(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,F=(t,a)=>{for(var l in a||(a={}))pe.call(a,l)&&fe(t,l,a[l]);if(H)for(var l of H(a))he.call(a,l)&&fe(t,l,a[l]);return t},J=(t,a)=>vt(t,wt(a)),gt=(t,a)=>{var l={};for(var o in t)pe.call(t,o)&&a.indexOf(o)<0&&(l[o]=t[o]);if(t!=null&&H)for(var o of H(t))a.indexOf(o)<0&&he.call(t,o)&&(l[o]=t[o]);return l};function Dt(t,a){return a.label.toLowerCase().trim().includes(t.toLowerCase().trim())}function St(t,a){return!!t&&!a.some(l=>l.label.toLowerCase()===t.toLowerCase())}const It={required:!1,size:"sm",shadow:"sm",itemComponent:rt,transition:"fade",transitionDuration:0,initiallyOpened:!1,filter:Dt,maxDropdownHeight:220,searchable:!1,clearable:!1,limit:1/0,disabled:!1,creatable:!1,shouldCreate:St,selectOnBlur:!1,switchDirectionOnFlip:!1,filterDataOnExactSearchMatch:!1,zIndex:lt("popover"),clearButtonTabIndex:0,positionDependencies:[],dropdownPosition:"flip"},xt=w.forwardRef((t,a)=>{const l=ft("Select",It,t),{inputProps:o,wrapperProps:_,shadow:M,data:j,value:y,defaultValue:P,onChange:d,itemComponent:R,onKeyDown:E,onBlur:Q,onFocus:X,transition:me,transitionDuration:be,initiallyOpened:ve,transitionTimingFunction:yt,unstyled:Y,classNames:O,styles:L,filter:we,maxDropdownHeight:ge,searchable:m,clearable:K,nothingFound:ee,clearButtonLabel:De,limit:Se,disabled:$,onSearchChange:A,searchValue:Ie,rightSection:xe,rightSectionWidth:ye,creatable:Oe,getCreateLabel:te,shouldCreate:Ce,selectOnBlur:_e,onCreate:ne,dropdownComponent:Pe,onDropdownClose:Ee,onDropdownOpen:Ve,withinPortal:Be,switchDirectionOnFlip:Fe,zIndex:Re,name:Le,dropdownPosition:Te,allowDeselect:ae,placeholder:ke,filterDataOnExactSearchMatch:ze,clearButtonTabIndex:Ne,form:He,positionDependencies:Me,readOnly:D}=l,je=gt(l,["inputProps","wrapperProps","shadow","data","value","defaultValue","onChange","itemComponent","onKeyDown","onBlur","onFocus","transition","transitionDuration","initiallyOpened","transitionTimingFunction","unstyled","classNames","styles","filter","maxDropdownHeight","searchable","clearable","nothingFound","clearButtonLabel","limit","disabled","onSearchChange","searchValue","rightSection","rightSectionWidth","creatable","getCreateLabel","shouldCreate","selectOnBlur","onCreate","dropdownComponent","onDropdownClose","onDropdownOpen","withinPortal","switchDirectionOnFlip","zIndex","name","dropdownPosition","allowDeselect","placeholder","filterDataOnExactSearchMatch","clearButtonTabIndex","form","positionDependencies","readOnly"]),{classes:Ke,cx:$e,theme:Ae}=mt(),[i,Ue]=w.useState(ve),[b,s]=w.useState(-1),U=w.useRef(),T=w.useRef({}),[le,We]=w.useState("column"),S=le==="column",{scrollIntoView:V,targetRef:W,scrollableRef:qe}=st({duration:0,offset:5,cancelable:!1,isList:!0}),Ze=ae===void 0?K:ae,f=e=>{if(i!==e){Ue(e);const n=e?Ve:Ee;typeof n=="function"&&n()}},q=Oe&&typeof te=="function";let Z=null;const Ge=j.map(e=>typeof e=="string"?{label:e,value:e}:e),k=it({data:Ge}),[p,C,oe]=ce({value:y,defaultValue:P,finalValue:null,onChange:d}),v=k.find(e=>e.value===p),[I,Je]=ce({value:Ie,defaultValue:(v==null?void 0:v.label)||"",finalValue:void 0,onChange:A}),x=e=>{Je(e),m&&typeof A=="function"&&A(e)},Qe=()=>{var e;D||(C(null),oe||x(""),(e=U.current)==null||e.focus())};w.useEffect(()=>{const e=k.find(n=>n.value===p);e?x(e.label):(!q||!p)&&x("")},[p]),w.useEffect(()=>{v&&(!m||!i)&&x(v.label)},[v==null?void 0:v.label]);const z=e=>{if(!D)if(Ze&&(v==null?void 0:v.value)===e.value)C(null),f(!1);else{if(e.creatable&&typeof ne=="function"){const n=ne(e.value);typeof n<"u"&&n!==null&&C(typeof n=="string"?n:n.value)}else C(e.value);oe||x(e.label),s(-1),f(!1),U.current.focus()}},r=pt({data:k,searchable:m,limit:Se,searchValue:I,filter:we,filterDataOnExactSearchMatch:ze,value:p});q&&Ce(I,r)&&(Z=te(I),r.push({label:I,value:I,creatable:!0}));const re=(e,n,c)=>{let u=e;for(;c(u);)if(u=n(u),!r[u].disabled)return u;return e};ue(()=>{s(-1)},[I]);const B=p?r.findIndex(e=>e.value===p):0,h=!D&&(r.length>0?i:i&&!!ee),se=()=>{s(e=>{var n;const c=re(e,u=>u-1,u=>u>0);return W.current=T.current[(n=r[c])==null?void 0:n.value],h&&V({alignment:S?"start":"end"}),c})},ie=()=>{s(e=>{var n;const c=re(e,u=>u+1,u=>u<r.length-1);return W.current=T.current[(n=r[c])==null?void 0:n.value],h&&V({alignment:S?"end":"start"}),c})},N=()=>window.setTimeout(()=>{var e;W.current=T.current[(e=r[B])==null?void 0:e.value],V({alignment:S?"end":"start"})},0);ue(()=>{h&&N()},[h]);const Xe=e=>{switch(typeof E=="function"&&E(e),e.key){case"ArrowUp":{e.preventDefault(),i?S?se():ie():(s(B),f(!0),N());break}case"ArrowDown":{e.preventDefault(),i?S?ie():se():(s(B),f(!0),N());break}case"Home":{if(!m){e.preventDefault(),i||f(!0);const n=r.findIndex(c=>!c.disabled);s(n),h&&V({alignment:S?"end":"start"})}break}case"End":{if(!m){e.preventDefault(),i||f(!0);const n=r.map(c=>!!c.disabled).lastIndexOf(!1);s(n),h&&V({alignment:S?"end":"start"})}break}case"Escape":{e.preventDefault(),f(!1),s(-1);break}case" ":{m||(e.preventDefault(),r[b]&&i?z(r[b]):(f(!0),s(B),N()));break}case"Enter":m||e.preventDefault(),r[b]&&i&&(e.preventDefault(),z(r[b]))}},Ye=e=>{typeof Q=="function"&&Q(e);const n=k.find(c=>c.value===p);_e&&r[b]&&i&&z(r[b]),x((n==null?void 0:n.label)||""),f(!1)},et=e=>{typeof X=="function"&&X(e),m&&f(!0)},tt=e=>{D||(x(e.currentTarget.value),K&&e.currentTarget.value===""&&C(null),s(-1),f(!0))},nt=()=>{D||(f(!i),p&&!i&&s(B))};return g.createElement(de.Wrapper,J(F({},_),{__staticSelector:"Select"}),g.createElement(G,{opened:h,transition:me,transitionDuration:be,shadow:"sm",withinPortal:Be,__staticSelector:"Select",onDirectionChange:We,switchDirectionOnFlip:Fe,zIndex:Re,dropdownPosition:Te,positionDependencies:Me,classNames:O,styles:L,unstyled:Y},g.createElement(G.Target,null,g.createElement("div",{role:"combobox","aria-haspopup":"listbox","aria-owns":h?`${o.id}-items`:null,"aria-controls":o.id,"aria-expanded":h,onMouseLeave:()=>s(-1),tabIndex:-1},g.createElement("input",{type:"hidden",name:Le,value:p||"",form:He,disabled:$}),g.createElement(de,F(J(F(F({autoComplete:"off",type:"search"},o),je),{ref:ot(a,U),onKeyDown:Xe,__staticSelector:"Select",value:I,placeholder:ke,onChange:tt,"aria-autocomplete":"list","aria-controls":h?`${o.id}-items`:null,"aria-activedescendant":b>=0?`${o.id}-${b}`:null,onMouseDown:nt,onBlur:Ye,onFocus:et,readOnly:!m||D,disabled:$,"data-mantine-stop-propagation":h,name:null,classNames:J(F({},O),{input:$e({[Ke.input]:!m},O==null?void 0:O.input)})}),ct({theme:Ae,rightSection:xe,rightSectionWidth:ye,styles:L,size:o.size,shouldClear:K&&!!v,clearButtonLabel:De,onClear:Qe,error:_.error,clearButtonTabIndex:Ne,disabled:$,readOnly:D}))))),g.createElement(G.Dropdown,{component:Pe||ut,maxHeight:ge,direction:le,id:o.id,innerRef:qe,__staticSelector:"Select",classNames:O,styles:L},g.createElement(dt,{data:r,hovered:b,classNames:O,styles:L,isItemSelected:e=>e===p,uuid:o.id,__staticSelector:"Select",onItemHover:s,onItemSelect:z,itemsRefs:T,itemComponent:R,size:o.size,nothingFound:ee,creatable:q&&!!Z,createLabel:Z,"aria-label":_.label,unstyled:Y}))))});xt.displayName="@mantine/core/Select";export{xt as S};
